<!--
$PostgreSQL: pgsql/doc/src/sgml/ref/create_resource_group.sgml,v 1.4.2.1 2006/10/05 03:06:17 dhutchinson Exp $
PostgreSQL documentation
-->

<refentry id="SQL-CREATERESOURCEGROUP">
 <refmeta>
  <refentrytitle id="sql-createresourcegroup-title">CREATE RESOURCE GROUP</refentrytitle>
  <refmiscinfo>SQL - Language Statements</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>CREATE RESOURCE GROUP</refname>
  <refpurpose>define a new resource group</refpurpose>
 </refnamediv>

 <indexterm zone="sql-createresourcegroup">
  <primary>CREATE RESOURCE GROUP</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>

CREATE RESOURCE GROUP name WITH (group_attribute=value [, ... ]) 
where group_attribute is:
   CPU_RATE_LIMIT=integer
   MEMORY_LIMIT=integer
   [ CONCURRENCY=integer ]
   [ MEMORY_SHARED_QUOTA=integer ]
   [ MEMORY_SPILL_RATIO=integer ]

</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>

  <para>
   Creates a new resource group for Greenplum Database resource 
   management. A resource group is assigned to one or more roles and
   identifies concurrent transaction, memory, and CPU limits for the
   role when resource groups are enabled.
  </para>
  <para>
   You must have <literal>SUPERUSER</literal> privileges to create a 
   resource group. The maximum number of resource groups allowed in 
   your Greenplum Database cluster is 100.
  </para>
  <para>
   Greenplum Database pre-defines two default resource groups: 
   <literal>admin_group</literal> and <literal>default_group</literal>. These group names, as well as the
   group name <literal>none</literal>, are reserved.
  </para>
  <para>
   To set appropriate limits for resource groups, the Greenplum 
   Database administrator must be familiar with the queries typically
   executed on the system, as well as the users/roles executing those
   queries.
  </para>
  <para>
   After creating a resource group, assign the group to one or more
   roles using the <xref linkend="SQL-ALTERROLE" endterm="SQL-ALTERROLE-title"> or <xref linkend="SQL-CREATEROLE" endterm="SQL-CREATEROLE-title"> command.
  </para>

 </refsect1>

 <refsect1>
  <title>Parameters</title>

    <variablelist>
     <varlistentry>
      <term><replaceable class="parameter">name</replaceable></term>
      <listitem>
       <para>
        The name of the resource group.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>CONCURRENCY</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The maximum number of concurrent transactions, including active
        and idle transactions, that are permitted for this resource group.
        The <literal>CONCURRENCY</literal> value must be an integer in the range
        [<literal>0 .. max_connections</literal>]. The default <literal>CONCURRENCY</literal>
         value is 20.
       </para>
       <para>
        You cannot set the <literal>CONCURRENCY</literal> value for the <literal>admin_group</literal>
        to zero (0).
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>CPU_RATE_LIMIT</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        Required. The percentage of CPU resources to allocate to this
        resource group. The minimum CPU percentage you can specify for a
        resource group is 1. The maximum is 100. The sum of the
        <literal>CPU_RATE_LIMIT</literal>s of all resource groups defined in the
        Greenplum Database cluster must be less than or equal to 100.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>MEMORY_LIMIT</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        Required. The total percentage of memory resources to allocate to
        this resource group. The minimum memory percentage you can specify
        for a resource group is 1. The maximum is 100. The sum of the
        <literal>MEMORY_LIMIT</literal>s of all resource groups defined in the
        Greenplum Database cluster must be less than or equal to 100.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>MEMORY_SHARED_QUOTA</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The quota of shared memory resources in the resource group.
        Resource groups with a <literal>MEMORY_SHARED_QUOTA</literal> threshold set
        aside a percentage of memory allotted to the resource group to
        share across transactions. This shared memory is allocated on a
        first-come, first-served basis as available. A transaction may
        use some, none, or all of this memory. The minimum memory shared
        quota that you can specify for a resource group is 0. The maximum
        is 100. The default <literal>MEMORY_SHARED_QUOTA</literal> value is 20.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>MEMORY_SPILL_RATIO</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The memory usage threshold for memory-intensive operators in a
        transaction. When the transaction reaches this threshold, it spills
        to disk. The minimum memory spill ratio percentage that you can
        specify for a resource group is 0. The maximum is 100. The default
        <literal>MEMORY_SPILL_RATIO</literal> value is 20.
       </para>
      </listitem>
     </varlistentry>

     </variablelist>
 </refsect1> 

 <refsect1>
  <title>Notes</title>
    <para>
     You cannot submit an <command>ALTER RESOURCE GROUP</command> command in an explicit
      transaction or sub-transaction.
    </para>

  <para>
   Use the <literal>gp_toolkit.gp_resgroup_config</literal> system view to display the
   limits settings of all resource groups.
  </para>

   </refsect1>

 <refsect1>
  <title>Examples</title>

  <para>
   Create a resource group with CPU and memory limit percentages of 35:
<programlisting>
CREATE RESOURCE GROUP rgroup1 WITH (CPU_RATE_LIMIT=35, MEMORY_LIMIT=35);
</programlisting>
  </para>

  <para>
   Create a resource group with a concurrent transaction limit of 30, a memory limit of 15, and a CPU limit of 25:
<programlisting>
CREATE RESOURCE GROUP rgroup2 WITH (CONCURRENCY=20, 
  MEMORY_LIMIT=15, CPU_RATE_LIMIT=25);
</programlisting>
  </para>

 </refsect1>
 
 <refsect1>
  <title>Compatibility</title>

  <para>
   <command>CREATE RESOURCE GROUP</command> is a Greenplum Database extension.
   There is no provision for resource groups in the SQL standard.
  </para>
   </refsect1>

 <refsect1>
  <title>See Also</title>

  <simplelist type="inline">
   <member><xref linkend="sql-createrole" endterm="sql-createrole-title"></member>
   <member><xref linkend="sql-alterrole" endterm="sql-alterrole-title"></member>
   <member><xref linkend="sql-alterresourcegroup" endterm="sql-alterresourcegroup-title"></member>
   <member><xref linkend="sql-dropresourcegroup" endterm="sql-dropresourcegroup-title"></member>
     </simplelist>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->
