<!--
$PostgreSQL: pgsql/doc/src/sgml/ref/alter_resource_group.sgml,v 1.4.2.1 2006/10/06 13:15:10 dhutchinson Exp $
PostgreSQL documentation
-->

<refentry id="SQL-ALTERRESOURCEGROUP">
 <refmeta>
  <refentrytitle id="sql-alterresourcequeue-title">ALTER RESOURCE GROUP</refentrytitle>
  <refmiscinfo>SQL - Language Statements</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>ALTER RESOURCE GROUP</refname>
  <refpurpose>change the limits of a resource group</refpurpose>
 </refnamediv>

 <indexterm zone="sql-alterresourcegroup">
  <primary>ALTER RESOURCE GROUP</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>

ALTER RESOURCE GROUP name SET group_attribute value
where group_attribute is one of:
   CONCURRENCY integer
   CPU_RATE_LIMIT integer
   MEMORY_LIMIT integer
   MEMORY_SHARED_QUOTA integer
   MEMORY_SPILL_RATIO integer

</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>

  <para>
   ALTER RESOURCE GROUP changes the limits of a resource group. 
   Only a superuser can alter a resource group.
  </para.

  <para>
   You can set or reset the concurrency limit of a resource group to
   control the maximum number of active concurrent statements in that
   group. You can also reset the memory or CPU rate limit of a resource
   group to control the amount of memory or CPU resources that all
   queries submitted through the group can consume on each segment host.
  </para>

  <para>
   The new resource limit is immediately applied if current resource 
   usage is less than or equal to the new value and there are no running
   transactions in the resource group. If current resource usage exceeds
   the new limit value, or there are running transactions in other
   resource groups holding some of the resource, Greenplum Database will
   defer the new limit assignment until resource usage is within the
   range of the new value.
  </para>

  <para>
   You can alter one limit type in a single <command>ALTER RESOURCE GROUP</command> call.
  </para>

  </refsect1>

 <refsect1>
  <title>Parameters</title>

    <variablelist>
     <varlistentry>
      <term><replaceable class="parameter">name</replaceable></term>
      <listitem>
       <para>
        The name of the resource group to alter.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>CONCURRENCY</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The maximum number of concurrent transactions, including active
        and idle transactions, that are permitted for this resource group.
        Any transactions submitted after the <literal>CONCURRENCY</literal> value limit
        is reached are queued. When a running transaction completes, the
        earliest queued transaction is executed.
       </para>
       <para>
        The <literal>CONCURRENCY</literal> value must be an integer in the range
        [<literal>0 .. max_connections</literal>]. The default <literal>CONCURRENCY<literal>
         value is 20.
       </para>
       <para>
        You cannot set the <literal>CONCURRENCY</literal> value for the <literal>admin_group</literal>
        to zero (0).
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>CPU_RATE_LIMIT</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The percentage of CPU resources to allocate to this resource group.
        The minimum CPU percentage for a resource group is 1. The maximum
        is 100. The sum of the <literal>CPU_RATE_LIMIT</literal>s of all resource groups
        defined in the Greenplum Database cluster must not exceed 100.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>MEMORY_LIMIT</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The percentage of memory resources to allocate to this resource
        group. The minimum memory percentage for a resource group is 1.
        The maximum is 100. The sum of the <literal>MEMORY_LIMIT</literal>s of all resource
        groups defined in the Greenplum Database cluster must not exceed
        100.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>MEMORY_SHARED_QUOTA</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The percentage of memory resources to share among transactions
        in the resource group. The minimum shared memory quota percentage
        for a resource group is 0.  The maximum is 100. The default 
        <literal>MEMORY_SHARED_QUOTA</literal> value is 20.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><literal>MEMORY_SPILL_RATIO</literal> <replaceable class="parameter">integer</replaceable></term>
       <listitem>
       <para>
        The memory usage threshold for memory-intensive operators in a
        transaction issued in the resource group. The minimum memory spill
        ratio percentage for a resource group is 0.  The maximum is 100.
        The default <literal>MEMORY_SPILL_RATIO</literal> value is 20.
       </para>
      </listitem>
     </varlistentry>

     </variablelist>
 </refsect1> 

 <refsect1>
  <title>Notes</title>

  <para>
   Use <xref linkend="SQL-CREATEROLE" endterm="SQL-CREATEROLE-title"> or
   <xref linkend="SQL-ALTERROLE" endterm="SQL-ALTERROLE-title"> 
   to assign a specific resource group to a role (user).
  </para>

  <para>
   You cannot submit an <command>ALTER RESOURCE GROUP</command> command in an explicit
   transaction or sub-transaction.
  </para>

 </refsect1>

 <refsect1>
  <title>Examples</title>

  <para>
   Change the active transaction limit for a resource group:
<programlisting>
ALTER RESOURCE GROUP rgroup1 SET CONCURRENCY 13;
</programlisting>
  </para>

  <para>
   Update the CPU limit for a resource group:
<programlisting>
ALTER RESOURCE GROUP rgroup2 SET CPU_RATE_LIMIT 45;
</programlisting>
  </para>

  <para>
   Update the memory limit for a resource group:
<programlisting>
ALTER RESOURCE GROUP rgroup3 SET MEMORY_LIMIT 30;
</programlisting>
  </para>

  <para> 
   Increase the memory spill ratio for a resource group from the default:
<programlisting>
ALTER RESOURCE GROUP rgroup4 SET MEMORY_SPILL_RATIO 25;
</programlisting>
  </para>

 </refsect1>
 
 <refsect1>
  <title>Compatibility</title>

  <para>
   The <command>ALTER RESOURCE GROUP</command> statement is a Greenplum Database
   extension. This command does not exist in standard PostgreSQL.
  </para>
   </refsect1>

 <refsect1>
  <title>See Also</title>

  <simplelist type="inline">
   <member><xref linkend="sql-createrole" endterm="sql-createrole-title"></member>
   <member><xref linkend="sql-alterrole" endterm="sql-alterrole-title"></member>
   <member><xref linkend="sql-createresourcegroup" endterm="sql-createresourcegroup-title"></member>
   <member><xref linkend="sql-dropresourcegroup" endterm="sql-dropresourcegroup-title"></member>
     </simplelist>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->
