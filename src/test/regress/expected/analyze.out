--
-- Setup
--
set default_statistics_target=25;
set allow_system_table_mods="DML";
set time zone 'Europe/Rome';
--
-- Test null fraction
--
-- 1. empty table should have NO stats
create table analyze_test (c int) distributed by (c);
analyze analyze_test;
select stanullfrac from pg_statistic where starelid = 'analyze_test'::regclass;
 stanullfrac 
-------------
(0 rows)

-- 2. table with ALL null values, expect to see 100% null values
insert into analyze_test values(null);
analyze analyze_test;
select stanullfrac from pg_statistic where starelid = 'analyze_test'::regclass;
 stanullfrac 
-------------
           1
(1 row)

-- 3. table with 1 null and 1 not-null values, expect to see 50% null values
insert into analyze_test values(1);
analyze analyze_test;
select stanullfrac from pg_statistic where starelid = 'analyze_test'::regclass;
 stanullfrac 
-------------
         0.5
(1 row)

-- 4. table with ALL not-null values, expect to see 0% null values
delete from analyze_test where c is null;
analyze analyze_test;
select stanullfrac from pg_statistic where starelid = 'analyze_test'::regclass;
 stanullfrac 
-------------
           0
(1 row)

-- 5. column marked as not null during creation, null frac should be 0
create table analyze_test2 (a int not null) distributed by (a);
insert into analyze_test2 values(1);
analyze analyze_test2;
select stanullfrac from pg_statistic where starelid = 'analyze_test2'::regclass;
 stanullfrac 
-------------
           0
(1 row)

-- Clean up
drop table analyze_test;
drop table analyze_test2;
--
-- Test attribute average width
--
-- both fixed length and variable length
create table analyze_test (a int, b text) distributed by (a);
-- 1. table with all null values, column width should be 0
insert into analyze_test values(null, null);
analyze analyze_test;
select stawidth from pg_statistic where starelid = 'analyze_test'::regclass;
 stawidth 
----------
        0
        0
(2 rows)

-- 2. regular case
insert into analyze_test select i, repeat('x',i*125) from generate_series(1, 10) i;
analyze analyze_test;
select stawidth from pg_statistic where starelid = 'analyze_test'::regclass;
 stawidth 
----------
        4
      691
(2 rows)

-- 3. all tuples are extremely wide (width > 1024 bytes)
truncate analyze_test;
insert into analyze_test select i, repeat('x',i*1250) from generate_series(1, 10) i;
analyze analyze_test;
select stawidth from pg_statistic where starelid = 'analyze_test'::regclass;
 stawidth 
----------
        4
     2680
(2 rows)

-- Clean up
truncate table analyze_test;
--
-- Test number of distinct values
--
-- 1. all values are null, using default ndistinct -1
insert into analyze_test values(null, null);
analyze analyze_test;
select stadistinct from pg_statistic where starelid = 'analyze_test'::regclass;
 stadistinct 
-------------
          -1
          -1
(2 rows)

-- 2. all values are unique, ndistinct should be -1
insert into analyze_test select i, i from generate_series(1,100) i;
analyze analyze_test;
select stadistinct from pg_statistic where starelid = 'analyze_test'::regclass;
 stadistinct 
-------------
          -1
          -1
(2 rows)

-- 3. none of the values are unique, ndistinct should not extrapolate based on sample ratio
insert into analyze_test select i%101, i%101 from generate_series(1,1000) i;
analyze analyze_test;
select stadistinct from pg_statistic where starelid = 'analyze_test'::regclass;
 stadistinct 
-------------
         101
         101
(2 rows)

-- 4. some values are repeated, some are not. ndistinct need to be extrapolated
insert into analyze_test select i, i from generate_series(1,1200) i;
analyze analyze_test;
select stadistinct from pg_statistic where starelid = 'analyze_test'::regclass;
 stadistinct 
-------------
   -0.521947
   -0.521947
(2 rows)

-- Clean up
truncate table analyze_test;
--
-- Test most common values(MCV), most common frequencies(MCF) and histogram
--
-- 1. stats are not collected if the column is all null values
insert into analyze_test select null, null from generate_series(1, 51) i;
analyze analyze_test;
select staattnum, stadistinct, stanumbers1, stavalues1, stavalues2 from pg_statistic where starelid = 'analyze_test'::regclass;
 staattnum | stadistinct | stanumbers1 | stavalues1 | stavalues2 
-----------+-------------+-------------+------------+------------
         1 |          -1 |             |            | 
         2 |          -1 |             |            | 
(2 rows)

-- 2. stats are not collected if the column is too wide
truncate table analyze_test;
insert into analyze_test select i, repeat('x',1025) from generate_series(1, 51) i;
analyze analyze_test;
select staattnum, stadistinct, stanumbers1, stavalues1, stavalues2 from pg_statistic where starelid = 'analyze_test'::regclass;
 staattnum | stadistinct | stanumbers1 | stavalues1 |                                 stavalues2                                 
-----------+-------------+-------------+------------+----------------------------------------------------------------------------
         1 |          -1 |             |            | {1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51}
         2 |          -1 |             |            | 
(2 rows)

-- 3. for boolean type we only need to collect MCV
create table analyze_test_bool (c boolean) distributed by (c);
insert into analyze_test_bool select i%2=0 from generate_series(1,55) i;
analyze analyze_test_bool;
select staattnum, stadistinct, stanumbers1, stavalues1, stavalues2 from pg_statistic where starelid = 'analyze_test_bool'::regclass;
 staattnum | stadistinct |     stanumbers1     | stavalues1 | stavalues2 
-----------+-------------+---------------------+------------+------------
         1 |           2 | {0.509091,0.490909} | {f,t}      | 
(1 row)

-- 4. histogram will be empty if bucket_size <= 1
truncate table analyze_test;
insert into analyze_test select i, repeat('x',i%5) from generate_series(1, 10) i;
analyze analyze_test;
select staattnum, stadistinct, stanumbers1, stavalues1, stavalues2 from pg_statistic where starelid = 'analyze_test'::regclass;
 staattnum | stadistinct |                stanumbers1                |       stavalues1       | stavalues2 
-----------+-------------+-------------------------------------------+------------------------+------------
         1 |          -1 | {0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1} | {1,2,3,4,5,6,7,8,9,10} | 
         2 |        -0.5 | {0.2,0.2,0.2,0.2,0.2}                     | {"",x,xx,xxx,xxxx}     | 
(2 rows)

insert into analyze_test select i, repeat('x',i%5) from generate_series(11, 25) i;
analyze analyze_test;
select staattnum, stadistinct, stanumbers1, stavalues1, stavalues2 from pg_statistic where starelid = 'analyze_test'::regclass;
 staattnum | stadistinct |                                                          stanumbers1                                                           |                             stavalues1                              | stavalues2 
-----------+-------------+--------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------+------------
         1 |          -1 | {0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04} | {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25} | 
         2 |        -0.2 | {0.2,0.2,0.2,0.2,0.2}                                                                                                          | {"",x,xx,xxx,xxxx}                                                  | 
(2 rows)

-- 5. Normal case
insert into analyze_test select i, repeat('x',i%25) from generate_series(1, 40) i;
analyze analyze_test;
select staattnum, stadistinct, stanumbers1, stavalues1, stavalues2 from pg_statistic where starelid = 'analyze_test'::regclass;
 staattnum | stadistinct |                                                                                                                         stanumbers1                                                                                                                         |                                                                                                                                                                stavalues1                                                                                                                                                                |                                                                                                                      stavalues2                                                                                                                      
-----------+-------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
         1 |   -0.615385 | {0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692} | {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25}                                                                                                                                                                                                                                                                      | {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,30,32,34,36,38,40}
         2 |   -0.384615 | {0.107692,0.107692,0.107692,0.107692,0.0923077,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0307692,0.0153846,0.0153846,0.0153846,0.0153846,0.0153846,0.0153846,0.0153846,0.0153846,0.0153846}     | {x,xx,xxx,xxxx,"",xxxxx,xxxxxx,xxxxxxx,xxxxxxxx,xxxxxxxxx,xxxxxxxxxx,xxxxxxxxxxx,xxxxxxxxxxxx,xxxxxxxxxxxxx,xxxxxxxxxxxxxx,xxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxxxxxx} | {"",x,xx,xxx,xxxx,xxxxx,xxxxxx,xxxxxxx,xxxxxxxx,xxxxxxxxx,xxxxxxxxxx,xxxxxxxxxxx,xxxxxxxxxxxx,xxxxxxxxxxxxx,xxxxxxxxxxxxxx,xxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxxxx,xxxxxxxxxxxxxxxxxxxxxxxx}
(2 rows)

--
-- Test with multiple columns, with different stats target
--
create table analyze_cols (
  a int, b text, c bigint,
  d double precision, e boolean,
  f char(50), g varchar(300),
  h date, i decimal(12,2), j real,
  k time, l timetz,
  m timestamp, n timestamptz
) distributed by (a);
update pg_attribute set attstattarget=0 where attrelid='analyze_cols'::regclass and attname='c';
update pg_attribute set attstattarget=1 where attrelid='analyze_cols'::regclass and attname='f';
update pg_attribute set attstattarget=2 where attrelid='analyze_cols'::regclass and attname='i';
update pg_attribute set attstattarget=51 where attrelid='analyze_cols'::regclass and attname='j';
update pg_attribute set attstattarget=70 where attrelid='analyze_cols'::regclass and attname='h';
update pg_attribute set attstattarget=100 where attrelid='analyze_cols'::regclass and attname='d';
insert into analyze_cols
  select x,
  repeat('abcdef',(x%73)*20),
  (x%71)*12345670,
  x*321.456,
  x%3=0,
  repeat('yz',x/4),
  repeat('abcd',x%73),
  date '2016-01-12' + (x%73)*10,
  7123.45*(x%19),
  123.456*(x%51),
  (x%24||':'||x%19)::time,
  (x%24||':'||x%19||':00+08')::timetz,
  ('2016-01-12 '||x%24||':'||x%59)::timestamp,
  ('2016-01-12 '||x%24||':'||x%25||':00+09')::timestamptz
  from generate_series(1, 100) x;
analyze analyze_cols;
select * from pg_stats where schemaname='public' and tablename='analyze_cols';
 schemaname |  tablename   | attname | null_frac | avg_width | n_distinct |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                most_common_vals                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                   most_common_freqs                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                            histogram_bounds                                                                                                                                                                                                                                                                                                                                                                                                             | correlation 
------------+--------------+---------+-----------+-----------+------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------
 public     | analyze_cols | a       |         0 |         4 |         -1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | {1,5,9,13,17,21,25,29,33,37,41,45,49,53,57,61,65,69,73,77,81,85,89,93,97,100}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |            
 public     | analyze_cols | b       |         0 |      2962 |         -1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |            
 public     | analyze_cols | d       |         0 |         8 |         -1 | {321.456,642.912,964.368,1285.824,1607.28,1928.736,2250.192,2571.648,2893.104,3214.56,3536.016,3857.472,4178.928,4500.384,4821.84,5143.296,5464.752,5786.208,6107.664,6429.12,6750.576,7072.032,7393.488,7714.944,8036.4,8357.856,8679.312,9000.768,9322.224,9643.68,9965.136,10286.592,10608.048,10929.504,11250.96,11572.416,11893.872,12215.328,12536.784,12858.24,13179.696,13501.152,13822.608,14144.064,14465.52,14786.976,15108.432,15429.888,15751.344,16072.8,16394.256,16715.712,17037.168,17358.624,17680.08,18001.536,18322.992,18644.448,18965.904,19287.36,19608.816,19930.272,20251.728,20573.184,20894.64,21216.096,21537.552,21859.008,22180.464,22501.92,22823.376,23144.832,23466.288,23787.744,24109.2,24430.656,24752.112,25073.568,25395.024,25716.48,26037.936,26359.392,26680.848,27002.304,27323.76,27645.216,27966.672,28288.128,28609.584,28931.04,29252.496,29573.952,29895.408,30216.864,30538.32,30859.776,31181.232,31502.688,31824.144,32145.6}                                                                                                                                                                                                                                                                                                                                                                                                | {0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01} |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |            
 public     | analyze_cols | e       |         0 |         1 |          2 | {f,t}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | {0.67,0.33}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |            
 public     | analyze_cols | f       |         0 |        51 |      -0.26 | {"yz                                                "}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | {0.04}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | {"                                                  ",yzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyzyz}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |            
 public     | analyze_cols | g       |         0 |       122 |      -0.73 | {abcd,abcdabcd,abcdabcdabcd,abcdabcdabcdabcd,abcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd,abcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd} | {0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02}                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |            
 public     | analyze_cols | h       |         0 |         4 |      -0.73 | {01-22-2016,02-01-2016,02-11-2016,02-21-2016,03-02-2016,03-12-2016,03-22-2016,04-01-2016,04-11-2016,04-21-2016,05-01-2016,05-11-2016,05-21-2016,05-31-2016,06-10-2016,06-20-2016,06-30-2016,07-10-2016,07-20-2016,07-30-2016,08-09-2016,08-19-2016,08-29-2016,09-08-2016,09-18-2016,09-28-2016,10-08-2016,01-12-2016,10-18-2016,10-28-2016,11-07-2016,11-17-2016,11-27-2016,12-07-2016,12-17-2016,12-27-2016,01-06-2017,01-16-2017,01-26-2017,02-05-2017,02-15-2017,02-25-2017,03-07-2017,03-17-2017,03-27-2017,04-06-2017,04-16-2017,04-26-2017,05-06-2017,05-16-2017,05-26-2017,06-05-2017,06-15-2017,06-25-2017,07-05-2017,07-15-2017,07-25-2017,08-04-2017,08-14-2017,08-24-2017,09-03-2017,09-13-2017,09-23-2017,10-03-2017,10-13-2017,10-23-2017,11-02-2017,11-12-2017,11-22-2017,12-02-2017}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | {0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01}                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |            
 public     | analyze_cols | i       |         0 |        10 |      -0.19 | {7123.45,14246.90}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | {0.06,0.06}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | {0.00,64111.05,128222.10}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |            
 public     | analyze_cols | j       |         0 |         4 |      -0.51 | {123.456,246.912,370.368,493.824,617.28,740.736,864.192,987.648,1111.1,1234.56,1358.02,1481.47,1604.93,1728.38,1851.84,1975.3,2098.75,2222.21,2345.66,2469.12,2592.58,2716.03,2839.49,2962.94,3086.4,3209.86,3333.31,3456.77,3580.22,3703.68,3827.14,3950.59,4074.05,4197.5,4320.96,4444.42,4567.87,4691.33,4814.78,4938.24,5061.7,5185.15,5308.61,5432.06,5555.52,5678.98,5802.43,5925.89,6049.34,0,6172.8}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | {0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.02,0.01,0.01}                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |            
 public     | analyze_cols | k       |         0 |         8 |         -1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | {00:01:00,01:01:00,01:16:00,02:12:00,03:08:00,04:04:00,05:01:00,06:02:00,07:03:00,08:04:00,09:00:00,10:01:00,11:02:00,12:03:00,13:04:00,14:00:00,15:01:00,16:02:00,17:03:00,18:04:00,19:00:00,20:01:00,21:02:00,22:03:00,23:00:00,23:14:00}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |            
 public     | analyze_cols | l       |         0 |        12 |         -1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | {00:01:00+08,01:01:00+08,01:16:00+08,02:12:00+08,03:08:00+08,04:04:00+08,05:01:00+08,06:02:00+08,07:03:00+08,08:04:00+08,09:00:00+08,10:01:00+08,11:02:00+08,12:03:00+08,13:04:00+08,14:00:00+08,15:01:00+08,16:02:00+08,17:03:00+08,18:04:00+08,19:00:00+08,20:01:00+08,21:02:00+08,22:03:00+08,23:00:00+08,23:14:00+08}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |            
 public     | analyze_cols | m       |         0 |         8 |         -1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | {"Tue Jan 12 00:13:00 2016","Tue Jan 12 01:01:00 2016","Tue Jan 12 01:49:00 2016","Tue Jan 12 02:39:00 2016","Tue Jan 12 03:27:00 2016","Tue Jan 12 04:17:00 2016","Tue Jan 12 05:05:00 2016","Tue Jan 12 06:06:00 2016","Tue Jan 12 07:07:00 2016","Tue Jan 12 08:08:00 2016","Tue Jan 12 09:09:00 2016","Tue Jan 12 10:10:00 2016","Tue Jan 12 11:00:00 2016","Tue Jan 12 12:01:00 2016","Tue Jan 12 13:02:00 2016","Tue Jan 12 14:03:00 2016","Tue Jan 12 15:04:00 2016","Tue Jan 12 16:05:00 2016","Tue Jan 12 17:06:00 2016","Tue Jan 12 18:07:00 2016","Tue Jan 12 19:08:00 2016","Tue Jan 12 20:09:00 2016","Tue Jan 12 21:10:00 2016","Tue Jan 12 22:11:00 2016","Tue Jan 12 23:12:00 2016","Tue Jan 12 23:47:00 2016"}                                                                                                         |            
 public     | analyze_cols | n       |         0 |         8 |         -1 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | {"Mon Jan 11 16:21:00 2016 CET","Mon Jan 11 17:00:00 2016 CET","Mon Jan 11 17:24:00 2016 CET","Mon Jan 11 18:23:00 2016 CET","Mon Jan 11 19:02:00 2016 CET","Mon Jan 11 20:01:00 2016 CET","Mon Jan 11 21:02:00 2016 CET","Mon Jan 11 22:03:00 2016 CET","Mon Jan 11 23:04:00 2016 CET","Tue Jan 12 00:05:00 2016 CET","Tue Jan 12 01:06:00 2016 CET","Tue Jan 12 02:07:00 2016 CET","Tue Jan 12 03:08:00 2016 CET","Tue Jan 12 04:09:00 2016 CET","Tue Jan 12 05:10:00 2016 CET","Tue Jan 12 06:11:00 2016 CET","Tue Jan 12 07:12:00 2016 CET","Tue Jan 12 08:13:00 2016 CET","Tue Jan 12 09:14:00 2016 CET","Tue Jan 12 10:15:00 2016 CET","Tue Jan 12 11:16:00 2016 CET","Tue Jan 12 12:17:00 2016 CET","Tue Jan 12 13:18:00 2016 CET","Tue Jan 12 14:19:00 2016 CET","Tue Jan 12 15:20:00 2016 CET","Tue Jan 12 15:23:00 2016 CET"} |            
(13 rows)

--
-- Clean up
--
drop table analyze_test_bool;
drop table analyze_test;
drop table analyze_cols;
set time zone default;
set allow_system_table_mods="NONE";
reset default_statistics_target;
