<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="gpssh" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../../out/commonltr.css" />
<title>gpssh</title>
</head>
<body id="topic1">

    <h1 class="title topictitle1" id="topic1__jx138388">gpssh</h1>

    <div class="body">
        <p class="p">Provides SSH access to multiple hosts at once.</p>

        <div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2>
            
            <pre class="pre codeblock"><code>gpssh { -f &lt;hostfile_gpssh&gt; | - h &lt;hostname&gt; [-h &lt;hostname&gt; ...] } <span class="ph">[-s] </span>[-e]
      [-d &lt;seconds&gt;] [-t &lt;multiplier&gt;] [-v]
      [&lt;bash_command&gt;]

gpssh -? 

gpssh --version</code></pre>
        </div>

        <div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2><p class="p">The <code class="ph codeph">gpssh</code> utility
                allows you to run bash shell commands on multiple hosts at once using SSH (secure
                shell). You can run a single command by specifying it on the command-line, or omit
                the command to enter into an interactive command-line session. </p>
<p class="p">To specify the
                hosts involved in the SSH session, use the <code class="ph codeph">-f</code> option to specify a
                file containing a list of host names, or use the <code class="ph codeph">-h</code> option to name
                single host names on the command-line. At least one host name (<code class="ph codeph">-h</code>)
                or a host file (<code class="ph codeph">-f</code>) is required. Note that the current host is
                        <strong class="ph b"><em class="ph i">not</em></strong> included in the session by default â€” to include the local
                host, you must explicitly declare it in the list of hosts involved in the
                session.</p>
<span class="ph"></span><p class="p">Before using <code class="ph codeph">gpssh</code>, you must have a trusted
                host setup between the hosts involved in the SSH session. You can use the utility
                    <code class="ph codeph">gpssh-exkeys</code> to update the known host files and exchange public
                keys between hosts if you have not done so already.</p>
<p class="p">If you do not specify a
                command on the command-line, <code class="ph codeph">gpssh</code> will go into interactive mode.
                At the <code class="ph codeph">gpssh</code> command prompt (<code class="ph codeph">=&gt;</code>), you can enter
                a command as you would in a regular bash terminal command-line, and the command will
                be run on all hosts involved in the session. To end an interactive session, press
                    <code class="ph codeph">CTRL</code>+<code class="ph codeph">D</code> on the keyboard or type
                    <code class="ph codeph">exit</code> or <code class="ph codeph">quit</code>.</p>
<p class="p">If a user name is not
                specified in the host file, <code class="ph codeph">gpssh</code> will run commands as the
                currently logged in user. To determine the currently logged in user, do a
                    <code class="ph codeph">whoami</code> command. By default, <code class="ph codeph">gpssh</code> goes to
                    <code class="ph codeph">$HOME</code> of the session user on the remote hosts after login. To
                ensure commands are run correctly on all remote hosts, you should always enter
                absolute paths.</p>
<p class="p">If you encounter network timeout problems when using
                    <code class="ph codeph">gpssh</code>, you can use <code class="ph codeph">-d</code> and <code class="ph codeph">-t</code>
                options or set parameters in the <code class="ph codeph">gpssh.conf</code> file to control the
                timing that <code class="ph codeph">gpssh</code> uses when validating the initial
                    <code class="ph codeph">ssh</code> connection. For information about the configuration file,
                see <a class="xref" href="#topic1__section6">gpssh Configuration File</a>.</p>
</div>

        <div class="section" id="topic1__section4"><h2 class="title sectiontitle">Options</h2>
            
            <dl class="dl parml">
                
                    <dt class="dt pt dlterm">
                        <var class="keyword varname">bash_command</var>
                    </dt>

                    <dd class="dd pd">A bash shell command to run on all hosts involved in this session
                        (optionally enclosed in quotes). If not specified, <code class="ph codeph">gpssh</code>
                        starts an interactive session.</dd>

                
                
                    <dt class="dt pt dlterm">-d (delay) <var class="keyword varname">seconds</var></dt>

                    <dd class="dd pd">Optional. Specifies the time, in seconds, to wait at the start of a
                            <code class="ph codeph">gpssh</code> interaction with <code class="ph codeph">ssh</code>. Default is
                            <code class="ph codeph">0.05</code>. This option overrides the
                            <code class="ph codeph">delaybeforesend</code> value that is specified in the
                            <code class="ph codeph">gpssh.conf</code> configuration file.</dd>

                    <dd class="dd pd ddexpand">Increasing this value can cause a long wait time during
                            <code class="ph codeph">gpssh</code> startup. </dd>

                
                
                    <dt class="dt pt dlterm">-e (echo)</dt>

                    <dd class="dd pd">Optional. Echoes the commands passed to each host and their resulting output
                        while running in non-interactive mode.</dd>

                
                
                    <dt class="dt pt dlterm">-f <var class="keyword varname">hostfile_gpssh</var></dt>

                    <dd class="dd pd">Specifies the name of a file that contains a list of hosts that will
                        participate in this SSH session. The syntax of the host file is one host
                        per line.</dd>

                
                
                    <dt class="dt pt dlterm">-h <var class="keyword varname">hostname</var></dt>

                    <dd class="dd pd">Specifies a single host name that will participate in this SSH session. You
                        can use the <code class="ph codeph">-h</code> option multiple times to specify multiple
                        host names.</dd>

                
                
                    <dt class="dt pt dlterm">-s</dt>

                    <dd class="dd pd">Optional. If specified, before running any commands on the target host,
                            <code class="ph codeph">gpssh</code> sources the file
                            <code class="ph codeph">greenplum_path.sh</code> in the directory specified by the
                            <code class="ph codeph">$GPHOME</code> environment variable. </dd>

                    <dd class="dd pd ddexpand">This option is valid for both interactive mode and single command mode.</dd>

                
                
                    <dt class="dt pt dlterm">-t <var class="keyword varname">multiplier</var>
                    </dt>

                    <dd class="dd pd">Optional. A decimal number greater than 0 (zero) that is the multiplier for
                        the timeout that <code class="ph codeph">gpssh</code> uses when validating the
                            <code class="ph codeph">ssh</code> prompt. Default is <code class="ph codeph">1</code>. This option
                        overrides the <code class="ph codeph">prompt_validation_timeout</code> value that is
                        specified in the <code class="ph codeph">gpssh.conf</code> configuration file.</dd>

                    <dd class="dd pd ddexpand">Increasing this value has a small impact during <code class="ph codeph">gpssh</code>
                        startup. </dd>

                
                
                    <dt class="dt pt dlterm">-v (verbose mode)</dt>

                    <dd class="dd pd">Optional. Reports additional messages in addition to the command output when
                        running in non-interactive mode.</dd>

                
                
                    <dt class="dt pt dlterm">--version</dt>

                    <dd class="dd pd">Displays the version of this utility.</dd>

                
                
                    <dt class="dt pt dlterm">-? (help)</dt>

                    <dd class="dd pd">Displays the online help.</dd>

                
            </dl>

        </div>

        <div class="section" id="topic1__section6"><h2 class="title sectiontitle">gpssh Configuration File</h2>
            
            <p class="p">The <code class="ph codeph">gpssh.conf</code> file contains parameters that let you adjust the
                timing that <code class="ph codeph">gpssh</code> uses when validating the initial
                    <code class="ph codeph">ssh</code> connection. These parameters affect the network connection
                before the <code class="ph codeph">gpssh</code> session runs commands with
                    <code class="ph codeph">ssh</code>. The location of the file is specified by the environment
                variable <code class="ph codeph">COORDINATOR_DATA_DIRECTORY</code>. If the environment variable is not
                defined or the <code class="ph codeph">gpssh.conf</code> file does not exist,
                    <code class="ph codeph">gpssh</code> uses the default values or the values set with the
                    <code class="ph codeph">-d</code> and <code class="ph codeph">-t</code> options. For information about the
                environment variable, see the <cite class="cite">Greenplum Database Reference Guide</cite>. </p>

            <p class="p">The <code class="ph codeph">gpssh.conf</code> file is a text file that consists of a
                    <code class="ph codeph">[gpssh]</code> section and parameters. On a line, the
                    <code class="ph codeph">#</code> (pound sign) indicates the start of a comment. This is an
                example <code class="ph codeph">gpssh.conf</code> file.</p>

            <pre class="pre codeblock"><code>[gpssh]
delaybeforesend = 0.05
prompt_validation_timeout = 1.0
sync_retries = 5</code></pre>
            <p class="p">These are the <code class="ph codeph">gpssh.conf</code> parameters.</p>

            <dl class="dl parml">
                
                    <dt class="dt pt dlterm">delaybeforesend = <var class="keyword varname">seconds</var></dt>

                    <dd class="dd pd">Specifies the time, in seconds, to wait at the start of a
                            <code class="ph codeph">gpssh</code> interaction with <code class="ph codeph">ssh</code>. Default is
                        0.05. Increasing this value can cause a long wait time during
                            <code class="ph codeph">gpssh</code> startup. The <code class="ph codeph">-d</code> option overrides
                        this parameter.</dd>

                
                
                    <dt class="dt pt dlterm">prompt_validation_timeout = <var class="keyword varname">multiplier</var></dt>

                    <dd class="dd pd">A decimal number greater than 0 (zero) that is the multiplier for the
                        timeout that <code class="ph codeph">gpssh</code> uses when validating the
                            <code class="ph codeph">ssh</code> prompt. Increasing this value has a small impact
                        during <code class="ph codeph">gpssh</code> startup. Default is <code class="ph codeph">1</code>. The
                            <code class="ph codeph">-t</code> option overrides this parameter.</dd>

                
                
                    <dt class="dt pt dlterm">sync_retries = <var class="keyword varname">attempts</var></dt>

                    <dd class="dd pd">A non-negative integer that specifies the maximum number of times that
                            <code class="ph codeph">gpssh</code> attempts to connect to a remote Greenplum
                        Database host. The default is 3. If the value is 0, <code class="ph codeph">gpssh</code>
                        returns an error if the initial connection attempt fails. Increasing the
                        number of attempts also increases the time between retry attempts. This
                        parameter cannot be configured with a command-line option. </dd>

                    <dd class="dd pd ddexpand">The <code class="ph codeph">-t</code> option also affects the time between retry
                        attempts.</dd>

                    <dd class="dd pd ddexpand">Increasing this value can compensate for slow network performance or segment
                        host performance issues such as heavy CPU or I/O load. However, when a
                        connection cannot be established, an increased value also increases the
                        delay when an error is returned.</dd>

                
            </dl>

        </div>

        <div class="section" id="topic1__section5"><h2 class="title sectiontitle">Examples</h2>
            
            <p class="p">Start an interactive group SSH session with all hosts listed in the file
                    <code class="ph codeph">hostfile_gpssh</code>:</p>

            <pre class="pre codeblock"><code>$ gpssh -f hostfile_gpssh</code></pre>
            <p class="p">At the <code class="ph codeph">gpssh</code> interactive command prompt, run a shell command on all
                the hosts involved in this session.</p>

            <pre class="pre codeblock"><code>=&gt; ls -a /data/primary/*</code></pre>
            <p class="p">Exit an interactive session:</p>

            <pre class="pre codeblock"><code>=&gt; exit
=&gt; quit</code></pre>
            <p class="p">Start a non-interactive group SSH session with the hosts named <code class="ph codeph">sdw1</code>
                and <code class="ph codeph">sdw2</code> and pass a file containing several commands named
                    <code class="ph codeph">command_file</code> to <code class="ph codeph">gpssh</code>:</p>

            <pre class="pre codeblock"><code>$ gpssh -h sdw1 -h sdw2 -v -e &lt; command_file</code></pre>
            <p class="p">Run single commands in non-interactive mode on hosts <code class="ph codeph">sdw2</code> and
                    <code class="ph codeph">localhost</code>:</p>

            <pre class="pre codeblock"><code>$ gpssh -h sdw2 -h localhost -v -e 'ls -a /data/primary/*'
$ gpssh -h sdw2 -h localhost -v -e 'echo $GPHOME'
$ gpssh -h sdw2 -h localhost -v -e 'ls -1 | wc -l'</code></pre>
        </div>

        <div class="section"><h2 class="title sectiontitle">See Also</h2>
            
            <p class="p"><a class="xref" href="gpssh-exkeys.html#topic1">gpssh-exkeys</a>, <a class="xref" href="gpscp.html#topic1">gpscp</a></p>

        </div>

    </div>

</body>
</html>