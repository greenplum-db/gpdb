<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="gpfdist" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../../out/commonltr.css" />
<title>gpfdist</title>
</head>
<body id="topic1">

  <h1 class="title topictitle1" id="topic1__ku137116">gpfdist</h1>

  <div class="body">
    <p class="p">Serves data files to or writes data files out from Greenplum Database segments.</p>

    <div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2>
      
      <pre class="pre codeblock"><code>gpfdist [-d &lt;directory&gt;] [-p &lt;http_port&gt;] [-P &lt;last_http_port&gt;] [-l &lt;log_file&gt;]
   [-t &lt;timeout&gt;] [-S] [-w &lt;time&gt;] [-v | -V] [-s] [-m &lt;max_length&gt;]
   [--ssl &lt;certificate_path&gt; [--sslclean &lt;wait_time&gt;] ]
   [-c &lt;config.yml&gt;]

gpfdist -? | --help 

gpfdist --version</code></pre>
    </div>

    <div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2>
      
      <p class="p"><code class="ph codeph">gpfdist</code> is Greenplum Database parallel file distribution program. It is
        used by readable external tables and <code class="ph codeph">gpload</code> to serve external table files
        to all Greenplum Database segments in parallel. It is used by writable external tables to
        accept output streams from Greenplum Database segments in parallel and write them out to a
        file.</p>

      <div class="note"><span class="notetitle">Note:</span> <code class="ph codeph">gpfdist</code> and <code class="ph codeph">gpload</code> are compatible only with the
        Greenplum Database major version in which they are shipped. For example, a
          <code class="ph codeph">gpfdist</code> utility that is installed with Greenplum Database 4.x cannot be
        used with Greenplum Database 5.x or 6.x.</div>

      <p class="p">In order for <code class="ph codeph">gpfdist</code> to be used by an external table, the
          <code class="ph codeph">LOCATION</code> clause of the external table definition must specify the
        external table data using the <code class="ph codeph">gpfdist://</code> protocol (see the Greenplum
        Database command <code class="ph codeph">CREATE EXTERNAL TABLE</code>). </p>

      <div class="note"><span class="notetitle">Note:</span> If the <code class="ph codeph">--ssl</code> option is specified to enable SSL security, create the
        external table with the <code class="ph codeph">gpfdists://</code> protocol.</div>

      <p class="p">The benefit of using <code class="ph codeph">gpfdist</code> is that you are guaranteed maximum
        parallelism while reading from or writing to external tables, thereby offering the best
        performance as well as easier administration of external tables.</p>

      <p class="p">For readable external tables, <code class="ph codeph">gpfdist</code> parses and serves data files evenly
        to all the segment instances in the Greenplum Database system when users
          <code class="ph codeph">SELECT</code> from the external table. For writable external tables,
          <code class="ph codeph">gpfdist</code> accepts parallel output streams from the segments when users
          <code class="ph codeph">INSERT</code> into the external table, and writes to an output file.</p>

      <div class="note"><span class="notetitle">Note:</span> When <code class="ph codeph">gpfdist</code> reads data and encounters a data formatting error, the
        error message includes a row number indicating the location of the formatting error.
          <code class="ph codeph">gpfdist</code> attempts to capture the row that contains the error. However,
          <code class="ph codeph">gpfdist</code> might not capture the exact row for some formatting
        errors.</div>

      <p class="p">For readable external tables, if load files are compressed using <code class="ph codeph">gzip</code> or
          <code class="ph codeph">bzip2</code> (have a <code class="ph codeph">.gz</code> or <code class="ph codeph">.bz2</code> file
        extension), <code class="ph codeph">gpfdist</code> uncompresses the data while loading the data (on the
        fly). For writable external tables, <code class="ph codeph">gpfdist</code> compresses the data using
          <code class="ph codeph">gzip</code> if the target file has a <code class="ph codeph">.gz</code> extension.</p>

      <div class="note"><span class="notetitle">Note:</span> Compression is not supported for readable and writeable external tables when
        the <code class="ph codeph">gpfdist</code> utility runs on Windows platforms.</div>

      <p class="p">When reading or writing data with the <code class="ph codeph">gpfdist</code> or <code class="ph codeph">gpfdists</code>
        protocol, Greenplum Database includes <code class="ph codeph">X-GP-PROTO</code> in the HTTP request header
        to indicate that the request is from Greenplum Database. The utility rejects HTTP requests
        that do not include <code class="ph codeph">X-GP-PROTO</code> in the request header.</p>

      <p class="p">Most likely, you will want to run <code class="ph codeph">gpfdist</code> on your ETL machines rather than
        the hosts where Greenplum Database is installed. To install <code class="ph codeph">gpfdist</code> on
        another host, simply copy the utility over to that host and add <code class="ph codeph">gpfdist</code> to
        your <code class="ph codeph">$PATH</code>.</p>

      <div class="note"><span class="notetitle">Note:</span> When using IPv6, always enclose the numeric IP address in brackets.</div>

    </div>

    <div class="section" id="topic1__section4"><h2 class="title sectiontitle">Options</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">-d <var class="keyword varname">directory</var></dt>

          <dd class="dd pd">The directory from which <code class="ph codeph">gpfdist</code> will serve files for readable
            external tables or create output files for writable external tables. If not specified,
            defaults to the current directory.</dd>

        
        
          <dt class="dt pt dlterm">-l <var class="keyword varname">log_file</var></dt>

          <dd class="dd pd">The fully qualified path and log file name where standard output messages are to be
            logged.</dd>

        
        
          <dt class="dt pt dlterm">-p <var class="keyword varname">http_port</var></dt>

          <dd class="dd pd">The HTTP port on which <code class="ph codeph">gpfdist</code> will serve files. Defaults to
            8080.</dd>

        
        
          <dt class="dt pt dlterm">-P <var class="keyword varname">last_http_port</var></dt>

          <dd class="dd pd">The last port number in a range of HTTP port numbers (<var class="keyword varname">http_port</var> to
              <var class="keyword varname">last_http_port</var>, inclusive) on which <code class="ph codeph">gpfdist</code> will
            attempt to serve files. <code class="ph codeph">gpfdist</code> serves the files on the first port
            number in the range to which it successfully binds.</dd>

        
        
          <dt class="dt pt dlterm">-t <var class="keyword varname">timeout</var></dt>

          <dd class="dd pd">Sets the time allowed for Greenplum Database to establish a connection to a
              <code class="ph codeph">gpfdist</code> process. Default is 5 seconds. Allowed values are 2 to 7200
            seconds (2 hours). May need to be increased on systems with a lot of network
            traffic.</dd>

        
        
          <dt class="dt pt dlterm">-m <var class="keyword varname">max_length</var></dt>

          <dd class="dd pd">Sets the maximum allowed data row length in bytes. Default is 32768. Should be used
            when user data includes very wide rows (or when <code class="ph codeph">line too long</code> error
            message occurs). Should not be used otherwise as it increases resource allocation. Valid
            range is 32K to 256MB. (The upper limit is 1MB on Windows systems.)</dd>

          <dd class="dd pd ddexpand">
            <div class="note"><span class="notetitle">Note:</span> Memory issues might occur if you specify a large maximum row length and run a
              large number of <code class="ph codeph">gpfdist</code> concurrent connections. For example, setting
              this value to the maximum of 256MB with 96 concurrent <code class="ph codeph">gpfdist</code>
              processes requires approximately 24GB of memory (<code class="ph codeph">(96 + 1) x
              246MB</code>).</div>

          </dd>

        
        
          <dt class="dt pt dlterm">-s</dt>

          <dd class="dd pd">
            <p class="p">Enables simplified logging. When this option is specified, only messages with
                <code class="ph codeph">WARN</code> level and higher are written to the <code class="ph codeph">gpfdist</code>
              log file. <code class="ph codeph">INFO</code> level messages are not written to the log file. If
              this option is not specified, all <code class="ph codeph">gpfdist</code> messages are written to the
              log file. </p>

          </dd>

          <dd class="dd pd ddexpand">You can specify this option to reduce the information written to the log file. </dd>

        
        
          <dt class="dt pt dlterm">-S (use O_SYNC)</dt>

          <dd class="dd pd">Opens the file for synchronous I/O with the <code class="ph codeph">O_SYNC</code> flag. Any writes
            to the resulting file descriptor block <code class="ph codeph">gpfdist</code> until the data is
            physically written to the underlying hardware.</dd>

        
        
          <dt class="dt pt dlterm">-w <var class="keyword varname">time</var></dt>

          <dd class="dd pd">Sets the number of seconds that Greenplum Database delays before closing a target file
            such as a named pipe. The default value is 0, no delay. The maximum value is 7200
            seconds (2 hours). </dd>

          <dd class="dd pd ddexpand">For a Greenplum Database with multiple segments, there might be a delay between
            segments when writing data from different segments to the file. You can specify a time
            to wait before Greenplum Database closes the file to ensure all the data is written to
            the file. </dd>

        
        
          <dt class="dt pt dlterm">--ssl <var class="keyword varname">certificate_path</var></dt>

          <dd class="dd pd">Adds SSL encryption to data transferred with <code class="ph codeph">gpfdist</code>. After running
              <code class="ph codeph">gpfdist</code> with the <code class="ph codeph">--ssl
              <var class="keyword varname">certificate_path</var></code> option, the only way to load data from
            this file server is with the <code class="ph codeph">gpfdist://</code> protocol. <span class="ph">For information
              on the <code class="ph codeph">gpfdist://</code> protocol, see "Loading and Unloading Data" in the
                <em class="ph i">Greenplum Database Administrator Guide</em>.</span></dd>

          <dd class="dd pd ddexpand">The location specified in <var class="keyword varname">certificate_path</var> must contain the
            following files:<ul class="ul" id="topic1__ul_dyp_eqt_mo">
              <li class="li" id="topic1__ku140282">The server certificate file, <code class="ph codeph">server.crt</code></li>

              <li class="li" id="topic1__ku140283">The server private key file, <code class="ph codeph">server.key</code></li>

              <li class="li" id="topic1__ku140284">The trusted certificate authorities, <code class="ph codeph">root.crt</code></li>

            </ul>
<p class="p">The root directory (<code class="ph codeph">/</code>) cannot be specified as
                <var class="keyword varname">certificate_path</var>.</p>
</dd>

        
        
          <dt class="dt pt dlterm">--sslclean <var class="keyword varname">wait_time</var></dt>

          <dd class="dd pd">When the utility is run with the <code class="ph codeph">--ssl</code> option, sets the number of
            seconds that the utility delays before closing an SSL session and cleaning up the SSL
            resources after it completes writing data to or from a Greenplum Database segment. The
            default value is 0, no delay. The maximum value is 500 seconds. If the delay is
            increased, the transfer speed decreases.</dd>

          <dd class="dd pd ddexpand">In some cases, this error might occur when copying large amounts of data:
              <code class="ph codeph">gpfdist server closed connection</code>. To avoid the error, you can add a
            delay, for example <code class="ph codeph">--sslclean 5</code>. </dd>

        
        
          <dt class="dt pt dlterm">-c <var class="keyword varname">config.yaml</var></dt>

          <dd class="dd pd">Specifies rules that <code class="ph codeph">gpfdist</code> uses to select a transform to apply when
            loading or extracting data. The <code class="ph codeph">gpfdist</code> configuration file is a YAML
            1.1 document. </dd>

          <dd class="dd pd ddexpand">For information about the file format, see <a class="xref" href="../../admin_guide/load/topics/transforming-xml-data.html#topic83" target="_blank">Configuration File Format</a> in the
              <cite class="cite">Greenplum Database Administrator Guide</cite>. For information about configuring
            data transformation with <code class="ph codeph">gpfdist</code>, see <a class="xref" href="../../admin_guide/load/topics/transforming-xml-data.html#topic75" target="_blank">Transforming External Data with gpfdist and gpload</a> in the
              <cite class="cite">Greenplum Database Administrator Guide</cite>.</dd>

          <dd class="dd pd ddexpand">This option is not available on Windows platforms.</dd>

        
        
          <dt class="dt pt dlterm">-v (verbose)</dt>

          <dd class="dd pd">Verbose mode shows progress and status messages.</dd>

        
        
          <dt class="dt pt dlterm">-V (very verbose)</dt>

          <dd class="dd pd">Verbose mode shows all output messages generated by this utility.</dd>

        
        
          <dt class="dt pt dlterm">-? (help)</dt>

          <dd class="dd pd">Displays the online help.</dd>

        
        
          <dt class="dt pt dlterm">--version</dt>

          <dd class="dd pd">Displays the version of this utility.</dd>

        
      </dl>

    </div>

    <div class="section"><h2 class="title sectiontitle">Notes</h2>
      
      <div class="p">The server configuration parameter <a class="xref" href="../../ref_guide/config_params/guc-list.html#verify_gpfdists_cert">verify_gpfdists_cert</a> controls whether SSL certificate authentication is enabled
        when Greenplum Database communicates with the <code class="ph codeph">gpfdist</code> utility to either
        read data from or write data to an external data source. You can set the parameter value to
          <code class="ph codeph">false</code> to disable authentication when testing the communication between
        the Greenplum Database external table and the <code class="ph codeph">gpfdist</code> utility that is
        serving the external data. If the value is <code class="ph codeph">false</code>, these SSL exceptions are
          ignored:<ul class="ul" id="topic1__ul_vvb_5lj_mdb">
          <li class="li">The self-signed SSL certificate that is used by <code class="ph codeph">gpfdist</code> is not
            trusted by Greenplum Database.</li>

          <li class="li">The host name contained in the SSL certificate does not match the host name that is
            running <code class="ph codeph">gpfdist</code>.</li>

        </ul>

        <div class="note warning"><span class="warningtitle">Warning:</span> Disabling SSL certificate authentication exposes a security risk by not
          validating the <code class="ph codeph">gpfdists</code> SSL certificate. </div>
</div>

      <p class="p">You can set the server configuration parameter <a class="xref" href="../../ref_guide/config_params/guc-list.html#gpfdist_retry_timeout">gpfdist_retry_timeout</a> to control the
        time that Greenplum Database waits before returning an error when a <code class="ph codeph">gpfdist</code>
        server does not respond while Greenplum Database is attempting to write data to
          <code class="ph codeph">gpfdist</code>. The default is 300 seconds (5 minutes).</p>

      <p class="p">If the <code class="ph codeph">gpfdist</code> utility hangs with no read or write activity occurring, you
        can generate a core dump the next time a hang occurs to help debug the issue. Set the
        environment variable <code class="ph codeph">GPFDIST_WATCHDOG_TIMER</code> to the number of seconds of no
        activity to wait before <code class="ph codeph">gpfdist</code> is forced to exit. When the environment
        variable is set and <code class="ph codeph">gpfdist</code> hangs, the utility is stopped after the
        specified number of seconds, creates a core dump, and sends relevant information to the log
        file.</p>

      <div class="p">This example sets the environment variable on a Linux system so that
          <code class="ph codeph">gpfdist</code> exits after 300 seconds (5 minutes) of no
        activity.<pre class="pre codeblock"><code>export GPFDIST_WATCHDOG_TIMER=300</code></pre></div>

    </div>

    <div class="section" id="topic1__section6"><h2 class="title sectiontitle">Examples</h2>
      
      <p class="p">To serve files from a specified directory using port 8081 (and start
          <code class="ph codeph">gpfdist</code> in the background):</p>

      <pre class="pre codeblock"><code>gpfdist -d /var/load_files -p 8081 &amp;</code></pre>
      <p class="p">To start <code class="ph codeph">gpfdist</code> in the background and redirect output and errors to a log
        file:</p>

      <pre class="pre codeblock"><code>gpfdist -d /var/load_files -p 8081 -l /home/gpadmin/log &amp;</code></pre>
      <p class="p">To stop <code class="ph codeph">gpfdist</code> when it is running in the background:</p>

      <p class="p">--First find its process id:</p>

      <pre class="pre codeblock"><code>ps ax | grep gpfdist</code></pre>
      <p class="p">--Then stop the process, for example:</p>

      <pre class="pre codeblock"><code>kill 3456</code></pre>
    </div>

    <div class="section" id="topic1__section7"><h2 class="title sectiontitle">See Also</h2>
      
      <p class="p"><a class="xref" href="gpload.html#topic1">gpload</a>, <code class="ph codeph">CREATE EXTERNAL
          TABLE</code><span class="ph"> in the <em class="ph i">Greenplum Database Reference Guide</em></span></p>

    </div>

  </div>

</body>
</html>