<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="pg_stat_last_operation" />
<meta name="DC.relation" scheme="URI" content="../system_catalogs/catalog_ref-html.html#topic1" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<meta name="DC.language" content="en" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>pg_stat_last_operation</title>
</head>
<body id="topic1">
<h1 class="title topictitle1" id="topic1__hr138336">pg_stat_last_operation</h1>
<div class="body"><p class="p">The pg_stat_last_operation table contains metadata tracking information
about database objects (tables, views, etc.).</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="topic1__hr138428" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table 1. </span>pg_catalog.pg_stat_last_operation</span></caption><colgroup><col style="width:131pt" /><col style="width:100pt" /><col style="width:82pt" /><col style="width:136pt" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry nocellnorowborder" style="vertical-align:top;" id="d93543e24">column</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d93543e26">type</th>
<th class="entry nocellnorowborder" style="vertical-align:top;" id="d93543e28">references</th>
<th class="entry cell-norowborder" style="vertical-align:top;" id="d93543e30">description</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138551">classid</code></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e26 ">oid</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e28 ">pg_class.oid</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d93543e30 ">OID of the system catalog containing the object.
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138559">objid</code></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e26 ">oid</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e28 ">any OID column</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d93543e30 ">OID of the object within its system catalog.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138567">staactionname</code></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e26 ">name</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e28 "> </td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d93543e30 ">The action that was taken on the object.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138575">stasysid</code></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e26 ">oid</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e28 ">pg_authid.oid</td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d93543e30 ">A foreign key to pg_authid.oid.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138583">stausename</code></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e26 ">name</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e28 "> </td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d93543e30 ">The name of the role that performed the operation
on this object.</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138447">stasubtype</code></td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e26 ">text</td>
<td class="entry nocellnorowborder" style="vertical-align:top;" headers="d93543e28 "> </td>
<td class="entry cell-norowborder" style="vertical-align:top;" headers="d93543e30 ">The type of object operated on or the subclass
of operation performed.</td>
</tr>
<tr class="row"><td class="entry row-nocellborder" style="vertical-align:top;" headers="d93543e24 "><code class="ph codeph" id="topic1__hr138456">statime</code></td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d93543e26 ">timestamp with timezone</td>
<td class="entry row-nocellborder" style="vertical-align:top;" headers="d93543e28 "> </td>
<td class="entry cellrowborder" style="vertical-align:top;" headers="d93543e30 ">The timestamp of the operation. This is the same timestamp that is written to
              the Greenplum Database server log files in case you need to look up more
              detailed information about the operation in the logs.</td>
</tr>
</tbody>
</table>
</div>


    <p class="p">The <code class="ph codeph">pg_stat_last_operation</code> table contains metadata tracking
      information about operations on database objects. This information includes the
      object id, DDL action, user, type of object, and operation timestamp. Greenplum
      Database updates this table when a database object is created, altered,
      truncated, vacuumed, analyzed, or partitioned, and when privileges are granted
      to an object.</p>

    <p class="p">If you want to track the operations performed on a specific object, use the
      <code class="ph codeph">objid</code> value. Because the <code class="ph codeph">stasubtype</code> value can
      identify either the type of object operated on or the subclass of operation
      performed, it is not a suitable parameter when querying the
      <code class="ph codeph">pg_stat_last_operation</code> table.</p>

    <p class="p">The following example creates and replaces a view, and then shows how to use
      <code class="ph codeph">objid</code> as a query parameter on the
      <code class="ph codeph">pg_stat_last_operation</code> table.</p>

    <pre class="pre codeblock"><code>testdb=# CREATE VIEW trial AS SELECT * FROM gp_segment_configuration;
CREATE VIEW
testdb=# CREATE OR REPLACE VIEW trial AS SELECT * FROM gp_segment_configuration;
CREATE VIEW
testdb=# SELECT * FROM pg_stat_last_operation WHERE objid='trial'::regclass::oid;
 classid | objid | staactionname | stasysid | stausename | stasubtype |            statime            
---------+-------+---------------+----------+------------+------------+-------------------------------
  1259  | 24735 | CREATE         |       10 | gpadmin    | VIEW       | 2020-04-07 16:44:28.808811+00
  1259  | 24735 | ALTER          |       10 | gpadmin    | SET        | 2020-04-07 16:44:38.110615+00
(2 rows)</code></pre>
    <p class="p">Notice that the <code class="ph codeph">pg_stat_last_operation</code> table entry for the         view <code class="ph codeph">REPLACE</code> operation specifies the <code class="ph codeph">ALTER</code>
      action (<code class="ph codeph">staactionname</code>) and the <code class="ph codeph">SET</code> subtype
      (<code class="ph codeph">stasubtype</code>).</p>

  </div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../system_catalogs/catalog_ref-html.html#topic1">System Catalogs Definitions</a></div>
</div>
</div></body>
</html>