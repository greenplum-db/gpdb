<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="CREATE VIEW" />
<meta name="DC.relation" scheme="URI" content="../sql_commands/sql_ref.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>CREATE VIEW</title>
</head>
<body id="topic1">

  <h1 class="title topictitle1" id="topic1__cj20941">CREATE VIEW</h1>

  <div class="body">
    <p class="p" id="topic1__sql_command_desc">Defines a new view.</p>

    <div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2>
      
      <pre class="pre codeblock" id="topic1__sql_command_synopsis"><code>CREATE [OR REPLACE] [TEMP | TEMPORARY] [RECURSIVE] VIEW &lt;name&gt; [ ( &lt;column_name&gt; [, ...] ) ]
    [ WITH ( view_option_name [= view_option_value] [, ... ] ) ]
    AS &lt;query&gt;
    [ WITH [ CASCADED | LOCAL ] CHECK OPTION ]</code></pre>
    </div>

    <div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2>
      
      <p class="p"><code class="ph codeph">CREATE VIEW</code> defines a view of a query. The view is not physically
        materialized. Instead, the query is run every time the view is referenced in a query. </p>

      <p class="p"><code class="ph codeph">CREATE OR REPLACE VIEW</code> is similar, but if a view of the same name already
        exists, it is replaced. The new query must generate the same columns that were generated by
        the existing view query (that is, the same column names in the same order, and with the same
        data types), but it may add additional columns to the end of the list. The calculations
        giving rise to the output columns may be completely different.</p>

      <p class="p">If a schema name is given then the view is created in the specified schema. Otherwise it is
        created in the current schema. Temporary views exist in a special schema, so a schema name
        may not be given when creating a temporary view. The name of the view must be distinct from
        the name of any other view, table, sequence, index or foreign table in the same schema.</p>

    </div>

    <div class="section" id="topic1__section4"><h2 class="title sectiontitle">Parameters</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">TEMPORARY | TEMP</dt>

          <dd class="dd pd">If specified, the view is created as a temporary view. Temporary views are
            automatically dropped at the end of the current session. Existing permanent relations
            with the same name are not visible to the current session while the temporary view
            exists, unless they are referenced with schema-qualified names. If any of the tables
            referenced by the view are temporary, the view is created as a temporary view (whether
              <code class="ph codeph">TEMPORARY</code> is specified or not). </dd>

        
        
          <dt class="dt pt dlterm">RECURSIVE</dt>

          <dd class="dd pd">Creates a recursive view. The syntax
            <pre class="pre codeblock"><code>
CREATE RECURSIVE VIEW [ &lt;schema&gt; . ] &lt;view_name&gt; (&lt;column_names&gt;) AS SELECT &lt;...&gt;;
</code></pre>
            is equivalent to
            <pre class="pre codeblock"><code>
CREATE VIEW [ &lt;schema&gt; . ] &lt;view_name&gt; AS WITH RECURSIVE &lt;view_name&gt; (&lt;column_names&gt;) AS (SELECT &lt;...&gt;) SELECT &lt;column_names&gt; FROM &lt;view_name&gt;;
</code></pre>
            A view column name list must be specified for a recursive view. </dd>

        
        
          <dt class="dt pt dlterm"><var class="keyword varname">name</var></dt>

          <dd class="dd pd">The name (optionally schema-qualified) of a view to be created. </dd>

        
        
          <dt class="dt pt dlterm"><var class="keyword varname">column_name</var></dt>

          <dd class="dd pd">An optional list of names to be used for columns of the view. If not given, the column
            names are deduced from the query. </dd>

        
        
          <dt class="dt pt dlterm">WITH ( <code class="ph codeph">view_option_name</code> [= <code class="ph codeph">view_option_value</code>] [, ...
            ] )</dt>

          <dd class="dd pd">This clause specifies optional parameters for a view; the following parameters are supported:<dl class="dl parml">
              
                <dt class="dt pt dlterm"><code class="ph codeph">check_option</code> (string)</dt>

                <dd class="dd pd">This parameter may be either <code class="ph codeph">local</code> or
                  <code class="ph codeph">cascaded</code>, and is equivalent to specifying <code class="ph codeph">WITH [ CASCADED
                    | LOCAL ] CHECK OPTION</code> (see below). This option can be changed on
                  existing views using <a class="xref" href="ALTER_VIEW.html#topic1">ALTER
                    VIEW</a>. </dd>

              
            </dl>
<dl class="dl parml">
              
                <dt class="dt pt dlterm"><code class="ph codeph">security_barrier</code> (boolean)</dt>

                <dd class="dd pd">This should be used if the view is intended to provide row-level security.</dd>

              
            </dl>
</dd>

        
        
          <dt class="dt pt dlterm"><var class="keyword varname">query</var></dt>

          <dd class="dd pd">A <a class="xref" href="SELECT.html#topic1">SELECT</a> or
                <a class="xref" href="VALUES.html#topic1">VALUES</a>
            command which will provide the columns and rows of the view.</dd>

        
      </dl>

    </div>

    <div class="section" id="topic1__section5"><h2 class="title sectiontitle">Notes</h2>
      
      <p class="p">Views in Greenplum Database are read only. The system will not allow an insert, update, or
        delete on a view. You can get the effect of an updatable view by creating rewrite rules on
        the view into appropriate actions on other tables. For more information see <code class="ph codeph">CREATE
          RULE</code>. </p>

      <p class="p">Be careful that the names and data types of the view's columns will be assigned the way you
        want. For example:</p>

      <pre class="pre codeblock"><code>CREATE VIEW vista AS SELECT 'Hello World';</code></pre>
      <p class="p">is bad form in two ways: the column name defaults to <code class="ph codeph">?column?</code>, and the
        column data type defaults to <code class="ph codeph">unknown</code>. If you want a string literal in a
        view's result, use something like:</p>

      <pre class="pre codeblock"><code>CREATE VIEW vista AS SELECT text 'Hello World' AS hello;</code></pre>
      <p class="p">Access to tables referenced in the view is determined by permissions of the view owner not
        the current user (even if the current user is a superuser). This can be confusing in the
        case of superusers, since superusers typically have access to all objects. In the case of a
        view, even superusers must be explicitly granted access to tables referenced in the view if
        they are not the owner of the view.</p>

      <p class="p">However, functions called in the view are treated the same as if they had been called
        directly from the query using the view. Therefore the user of a view must have permissions
        to call any functions used by the view.</p>

      <p class="p">If you create a view with an <code class="ph codeph">ORDER BY</code> clause, the <code class="ph codeph">ORDER
          BY</code> clause is ignored when you do a <code class="ph codeph">SELECT</code> from the view.</p>

      <p class="p">When <code class="ph codeph">CREATE OR REPLACE VIEW</code> is used on an existing view, only the view's
        defining <code class="ph codeph">SELECT</code> rule is changed. Other view properties, including
        ownership, permissions, and non-<code class="ph codeph">SELECT</code> rules, remain unchanged. You must
        own the view to replace it (this includes being a member of the owning role).</p>

    </div>

    <div class="section" id="topic1__section6"><h2 class="title sectiontitle">Examples</h2>
      
      <p class="p">Create a view consisting of all comedy films: </p>

      <pre class="pre codeblock"><code>CREATE VIEW comedies AS SELECT * FROM films 
WHERE kind = 'comedy';</code></pre>
      <p class="p">This will create a view containing the columns that are in the <code class="ph codeph">film</code> table
        at the time of view creation. Though <code class="ph codeph">*</code> was used to create the view, columns
        added later to the table will not be part of the view. </p>

      <p class="p">Create a view that gets the top ten ranked baby names:</p>

      <pre class="pre codeblock"><code>CREATE VIEW topten AS SELECT name, rank, gender, year FROM 
names, rank WHERE rank &lt; '11' AND names.id=rank.id;</code></pre>
      <p class="p">Create a recursive view consisting of the numbers from 1 to 100: </p>

      <pre class="pre codeblock"><code>CREATE RECURSIVE VIEW public.nums_1_100 (n) AS
    VALUES (1)
UNION ALL
    SELECT n+1 FROM nums_1_100 WHERE n &lt; 100;
      </code></pre>
      <p class="p"> Notice that although the recursive view's name is schema-qualified in this <code class="ph codeph">CREATE
          VIEW</code> command, its internal self-reference is not schema-qualified. This is
        because the implicitly-created CTE's name cannot be schema-qualified. </p>

    </div>

    <div class="section" id="topic1__section7"><h2 class="title sectiontitle">Compatibility</h2>
      
      <p class="p">The SQL standard specifies some additional capabilities for the <code class="ph codeph">CREATE
          VIEW</code> statement that are not in Greenplum Database. The optional clauses for the
        full SQL command in the standard are: </p>

      <ul class="ul">
        <li class="li" id="topic1__cj152047"><strong class="ph b">CHECK OPTION</strong> — This option has to do with updatable views. All
            <code class="ph codeph">INSERT</code> and <code class="ph codeph">UPDATE</code> commands on the view will be checked
          to ensure data satisfy the view-defining condition (that is, the new data would be visible
          through the view). If they do not, the update will be rejected.</li>

        <li class="li" id="topic1__cj152050"><strong class="ph b">LOCAL</strong> — Check for integrity on this view. </li>

        <li class="li" id="topic1__cj152053"><strong class="ph b">CASCADED</strong> — Check for integrity on this view and on any dependent
          view. <code class="ph codeph">CASCADED</code> is assumed if neither <code class="ph codeph">CASCADED</code> nor
            <code class="ph codeph">LOCAL</code> is specified. </li>

      </ul>

      <p class="p"><code class="ph codeph">CREATE OR REPLACE VIEW</code> is a Greenplum Database language extension. So is
        the concept of a temporary view. </p>

    </div>

    <div class="section" id="topic1__section8"><h2 class="title sectiontitle">See Also</h2>
      
      <p class="p"><a class="xref" href="SELECT.html#topic1">SELECT</a>,
            <a class="xref" href="DROP_VIEW.html#topic1">DROP VIEW</a>,
            <a class="xref" href="CREATE_MATERIALIZED_VIEW.html">CREATE MATERIALIZED VIEW</a></p>

    </div>

  </div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../sql_commands/sql_ref.html">SQL Commands</a></div>
</div>
</div></body>
</html>