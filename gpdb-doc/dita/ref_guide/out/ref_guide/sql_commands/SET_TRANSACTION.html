<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="SET TRANSACTION" />
<meta name="DC.relation" scheme="URI" content="../sql_commands/sql_ref.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>SET TRANSACTION</title>
</head>
<body id="topic1">

  <h1 class="title topictitle1" id="topic1__em20941">SET TRANSACTION</h1>

  <div class="body">
    <p class="p" id="topic1__sql_command_desc">Sets the characteristics of the current transaction.</p>

    <div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2>
      
      <pre class="pre codeblock" id="topic1__sql_command_synopsis"><code>SET TRANSACTION [&lt;transaction_mode&gt;] [READ ONLY | READ WRITE]

SET TRANSACTION SNAPSHOT &lt;snapshot_id&gt;

SET SESSION CHARACTERISTICS AS TRANSACTION &lt;transaction_mode&gt; 
     [READ ONLY | READ WRITE]
     [NOT] DEFERRABLE</code></pre>
      <p class="p">where <var class="keyword varname">transaction_mode</var> is one of:</p>

      <pre class="pre codeblock"><code>   ISOLATION LEVEL {SERIALIZABLE | REPEATABLE READ | READ COMMITTED | READ UNCOMMITTED}</code></pre>
    </div>

    <div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2>
      
      <p class="p">The <code class="ph codeph">SET TRANSACTION</code> command sets the characteristics of the current
        transaction. It has no effect on any subsequent transactions.</p>

      <p class="p">The available transaction characteristics are the transaction isolation level, the
        transaction access mode (read/write or read-only), and the deferrable mode. </p>

      <div class="note"><span class="notetitle">Note:</span> Deferrable transactions require the transaction to be serializable. Greenplum Database
        does not support serializable transactions, so including the <code class="ph codeph">DEFERRABLE</code>
        clause has no effect.</div>

      <p class="p">Greenplum Database does not support the <code class="ph codeph">SET TRANSACTION SNAPSHOT</code> command. </p>

      <p class="p">The isolation level of a transaction determines what data the transaction can see when
        other transactions are running concurrently.</p>

      <ul class="ul">
        <li class="li" id="topic1__em137940"><strong class="ph b">READ COMMITTED</strong> — A statement can only see rows committed before it
          began. This is the default. </li>

        <li class="li" id="topic1__em137943"><strong class="ph b">REPEATABLE READ</strong> — All statements in the current transaction can
          only see rows committed before the first query or data-modification statement run in
          the transaction.</li>

      </ul>

      <p class="p">The SQL standard defines two additional levels, <code class="ph codeph">READ UNCOMMITTED</code> and
          <code class="ph codeph">SERIALIZABLE</code>. In Greenplum Database <code class="ph codeph">READ UNCOMMITTED</code> is
        treated as <code class="ph codeph">READ COMMITTED</code>. If you specify <code class="ph codeph">SERIALIZABLE</code>,
        Greenplum Database falls back to <code class="ph codeph">REPEATABLE READ</code>.</p>

      <p class="p">The transaction isolation level cannot be changed after the first query or
        data-modification statement (<code class="ph codeph">SELECT</code>, <code class="ph codeph">INSERT</code>,
          <code class="ph codeph">DELETE</code>, <code class="ph codeph">UPDATE</code>, <code class="ph codeph">FETCH</code>, or
          <code class="ph codeph">COPY</code>) of a transaction has been run.</p>

      <p class="p">The transaction access mode determines whether the transaction is read/write or read-only.
        Read/write is the default. When a transaction is read-only, the following SQL commands are
        disallowed: <code class="ph codeph">INSERT</code>, <code class="ph codeph">UPDATE</code>, <code class="ph codeph">DELETE</code>, and
          <code class="ph codeph">COPY FROM</code> if the table they would write to is not a temporary table; all
          <code class="ph codeph">CREATE</code>, <code class="ph codeph">ALTER</code>, and <code class="ph codeph">DROP</code> commands;
          <code class="ph codeph">GRANT</code>, <code class="ph codeph">REVOKE</code>, <code class="ph codeph">TRUNCATE</code>; and
          <code class="ph codeph">EXPLAIN ANALYZE</code> and <code class="ph codeph">EXECUTE</code> if the command they would
        run is among those listed. This is a high-level notion of read-only that does not
        prevent all writes to disk.</p>

      <p class="p"> The <code class="ph codeph">DEFERRABLE</code> transaction property has no effect unless the transaction
        is also <code class="ph codeph">SERIALIZABLE</code> and <code class="ph codeph">READ ONLY</code>. When all of these
        properties are set on a transaction, the transaction may block when first acquiring its
        snapshot, after which it is able to run without the normal overhead of a
          <code class="ph codeph">SERIALIZABLE</code> transaction and without any risk of contributing to or being
        cancelled by a serialization failure. Because Greenplum Database does not support
        serializable transactions, the <code class="ph codeph">DEFERRABLE</code> transaction property has no
        effect in Greenplum Database. </p>

    </div>

    <div class="section" id="topic1__section4"><h2 class="title sectiontitle">Parameters</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">SESSION CHARACTERISTICS</dt>

          <dd class="dd pd">Sets the default transaction characteristics for subsequent transactions of a
            session.</dd>

        
        
          <dt class="dt pt dlterm">READ UNCOMMITTED</dt>

          <dt class="dt pt dlterm">READ COMMITTED</dt>

          <dt class="dt pt dlterm">REPEATABLE READ</dt>

          <dt class="dt pt dlterm">SERIALIZABLE</dt>

          <dd class="dd pd">The SQL standard defines four transaction isolation levels: <code class="ph codeph">READ
              UNCOMMITTED</code>, <code class="ph codeph">READ COMMITTED</code>, <code class="ph codeph">REPEATABLE
              READ</code>, and <code class="ph codeph">SERIALIZABLE</code>.</dd>

          <dd class="dd pd ddexpand"><code class="ph codeph">READ UNCOMMITTED</code> allows transactions to see changes made by
            uncomitted concurrent transactions. This is not possible in Greenplum Database, so
              <code class="ph codeph">READ UNCOMMITTED</code> is treated the same as <code class="ph codeph">READ
              COMMITTED</code>.</dd>

          <dd class="dd pd ddexpand"><code class="ph codeph">READ COMMITTED</code>, the default isolation level in Greenplum Database,
            guarantees that a statement can only see rows committed before it began. The same
            statement run twice in a transaction can produce different results if another
            concurrent transaction commits after the statement is run the first time. </dd>

          <dd class="dd pd ddexpand">The <code class="ph codeph">REPEATABLE READ</code> isolation level guarantees that a transaction can
            only see rows committed before it began. <code class="ph codeph">REPEATABLE READ</code> is the
            strictest transaction isolation level Greenplum Database supports. Applications that use
            the <code class="ph codeph">REPEATABLE READ</code> isolation level must be prepared to retry
            transactions due to serialization failures.</dd>

          <dd class="dd pd ddexpand">The <code class="ph codeph">SERIALIZABLE</code> transaction isolation level guarantees that all
            statements of the current transaction can only see rows committed before the first query
            or data-modification statement was run in this transaction. If a pattern of reads
            and writes among concurrent serializable transactions would create a situation which
            could not have occurred for any serial (one-at-a-time) execution of those transactions,
            one of the transactions will be rolled back with a
              <code class="ph codeph">serialization_failure</code> error. Greenplum Database does not fully
            support <code class="ph codeph">SERIALIZABLE</code> as defined by the standard, so if you specify
              <code class="ph codeph">SERIALIZABLE</code>, Greenplum Database falls back to <code class="ph codeph">REPEATABLE
              READ</code>. See <a class="xref" href="#topic1__section7">Compatibility</a> for more information
            about transaction serializability in Greenplum Database.</dd>

        
        
          <dt class="dt pt dlterm">READ WRITE</dt>

          <dt class="dt pt dlterm">READ ONLY</dt>

          <dd class="dd pd">Determines whether the transaction is read/write or read-only. Read/write is the
            default. When a transaction is read-only, the following SQL commands are disallowed:
              <code class="ph codeph">INSERT</code>, <code class="ph codeph">UPDATE</code>, <code class="ph codeph">DELETE</code>, and
              <code class="ph codeph">COPY FROM</code> if the table they would write to is not a temporary table;
            all <code class="ph codeph">CREATE</code>, <code class="ph codeph">ALTER</code>, and <code class="ph codeph">DROP</code> commands;
              <code class="ph codeph">GRANT</code>, <code class="ph codeph">REVOKE</code>, <code class="ph codeph">TRUNCATE</code>; and
              <code class="ph codeph">EXPLAIN ANALYZE</code> and <code class="ph codeph">EXECUTE</code> if the command they
            would run is among those listed.</dd>

        
        
          <dt class="dt pt dlterm">[NOT] DEFERRABLE</dt>

          <dd class="dd pd">The <code class="ph codeph">DEFERRABLE</code> transaction property has no effect in Greenplum
            Database because <code class="ph codeph">SERIALIZABLE</code> transactions are not supported. If
              <code class="ph codeph">DEFERRABLE</code> is specified and the transaction is also
              <code class="ph codeph">SERIALIZABLE</code> and <code class="ph codeph">READ ONLY</code>, the transaction may
            block when first acquiring its snapshot, after which it is able to run without the
            normal overhead of a <code class="ph codeph">SERIALIZABLE</code> transaction and without any risk of
            contributing to or being cancelled by a serialization failure. This mode is well suited
            for long-running reports or backups.</dd>

        
      </dl>

    </div>

    <div class="section" id="topic1__section5"><h2 class="title sectiontitle">Notes</h2>
      
      <p class="p">If <code class="ph codeph">SET TRANSACTION</code> is run without a prior <code class="ph codeph">START
          TRANSACTION</code> or <code class="ph codeph">BEGIN</code>, a warning is issued and the command has no
        effect. </p>

      <p class="p">It is possible to dispense with <code class="ph codeph">SET TRANSACTION</code> by instead specifying the
        desired transaction modes in <code class="ph codeph">BEGIN</code> or <code class="ph codeph">START TRANSACTION</code>. </p>

      <p class="p">The session default transaction modes can also be set by setting the configuration
        parameters <a class="xref" href="../config_params/guc-list.html#default_transaction_isolation"><var class="keyword varname">default_transaction_isolation</var></a>, <a class="xref" href="../config_params/guc-list.html#default_transaction_read_only"><var class="keyword varname">default_transaction_read_only</var></a>, and <a class="xref" href="../config_params/guc-list.html#default_transaction_deferrable">default_transaction_deferrable</a>.</p>

    </div>

    <div class="section" id="topic1__section6"><h2 class="title sectiontitle">Examples</h2>
      
      <p class="p">Set the transaction isolation level for the current transaction:</p>

      <pre class="pre codeblock"><code>BEGIN;
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;</code></pre>
    </div>

    <div class="section" id="topic1__section7"><h2 class="title sectiontitle">Compatibility</h2>
      
      <p class="p">Both commands are defined in the SQL standard. <code class="ph codeph">SERIALIZABLE</code> is the default
        transaction isolation level in the standard. In Greenplum Database the default is
          <code class="ph codeph">READ COMMITTED</code>. Due to lack of predicate locking, Greenplum Database does
        not fully support the <code class="ph codeph">SERIALIZABLE</code> level, so it falls back to the
          <code class="ph codeph">REPEATABLE READ</code> level when <code class="ph codeph">SERIAL</code> is specified.
        Essentially, a predicate-locking system prevents phantom reads by restricting what is
        written, whereas a multi-version concurrency control model (MVCC) as used in Greenplum
        Database prevents them by restricting what is read. </p>

      <p class="p">PostgreSQL provides a true serializable isolation level, called serializable snapshot
        isolation (SSI), which monitors concurrent transactions and rolls back transactions that
        could introduce serialization anomalies. Greenplum Database does not implement this
        isolation mode.</p>

      <p class="p">In the SQL standard, there is one other transaction characteristic that can be set with
        these commands: the size of the diagnostics area. This concept is specific to embedded SQL,
        and therefore is not implemented in the Greenplum Database server. </p>

      <p class="p">The <code class="ph codeph">DEFERRABLE</code> transaction mode is a Greenplum Database language
        extension.</p>

      <p class="p">The SQL standard requires commas between successive <var class="keyword varname">transaction_modes</var>,
        but for historical reasons Greenplum Database allows the commas to be omitted.</p>

    </div>

    <div class="section" id="topic1__section8"><h2 class="title sectiontitle">See Also</h2>
      
      <p class="p"><a class="xref" href="BEGIN.html#topic1">BEGIN</a>, <a class="xref" href="LOCK.html#topic1">LOCK</a></p>

    </div>

  </div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../sql_commands/sql_ref.html">SQL Commands</a></div>
</div>
</div></body>
</html>