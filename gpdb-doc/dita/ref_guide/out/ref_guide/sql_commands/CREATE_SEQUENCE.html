<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="CREATE SEQUENCE" />
<meta name="DC.relation" scheme="URI" content="../sql_commands/sql_ref.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>CREATE SEQUENCE</title>
</head>
<body id="topic1">
<h1 class="title topictitle1" id="topic1__cc20941">CREATE SEQUENCE</h1>
<div class="body"><p class="p" id="topic1__sql_command_desc">Defines a new sequence generator.</p>
<div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2><pre class="pre codeblock" id="topic1__sql_command_synopsis"><code>CREATE [TEMPORARY | TEMP] SEQUENCE &lt;name&gt;
       [INCREMENT [BY] &lt;value&gt;] 
       [MINVALUE &lt;minvalue&gt; | NO MINVALUE] 
       [MAXVALUE &lt;maxvalue&gt; | NO MAXVALUE] 
       [START [ WITH ] &lt;start&gt;] 
       [CACHE &lt;cache&gt;] 
       [[NO] CYCLE] 
       [OWNED BY { &lt;table&gt;.&lt;column&gt; | NONE }]</code></pre></div>
<div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2><p class="p"><code class="ph codeph">CREATE SEQUENCE</code> creates a new sequence number generator.
This involves creating and initializing a new special single-row table.
The generator will be owned by the user issuing the command. </p>
<p class="p">If a schema name is given, then the sequence is created in the specified
schema. Otherwise it is created in the current schema. Temporary sequences
exist in a special schema, so a schema name may not be given when creating
a temporary sequence. The sequence name must be distinct from the name
of any other sequence, table, index, view, or foreign table in the same schema. </p>
<p class="p">After a sequence is created, you use the <code class="ph codeph">nextval()</code>
function to operate on the sequence. For example, to insert a row into
a table that gets the next value of a sequence:</p>
<pre class="pre codeblock"><code>INSERT INTO distributors VALUES (nextval('myserial'), 'acme');</code></pre><p class="p">You can also use the function <code class="ph codeph">setval()</code> to operate on a
sequence, but only for queries that do not operate on distributed data.
For example, the following query is allowed because it resets the sequence
counter value for the sequence generator process on the master:</p>
<pre class="pre codeblock"><code>SELECT setval('myserial', 201);</code></pre><p class="p">But the following query will be rejected in Greenplum Database because
it operates on distributed data:</p>
<pre class="pre codeblock"><code>INSERT INTO product VALUES (setval('myserial', 201), 'gizmo');</code></pre><p class="p">In a regular (non-distributed) database, functions that operate on the
sequence go to the local sequence table to get values as they are needed.
 In Greenplum Database, however, keep in mind that each segment is its
own distinct database process. Therefore the segments need a single point
of truth to go for sequence values so that all segments get incremented
correctly and the sequence moves forward in the right order. A sequence
server process runs on the master and is the point-of-truth for a sequence
in a Greenplum distributed database. Segments get sequence values at
runtime from the master.</p>
<p class="p">Because of this distributed sequence design, there are some limitations
on the functions that operate on a sequence in Greenplum Database:</p>
<ul class="ul"><li class="li" id="topic1__cc148439"><code class="ph codeph">lastval()</code> and <code class="ph codeph">currval()</code> functions are
not supported. </li>
<li class="li" id="topic1__cc149500"><code class="ph codeph">setval()</code> can only be used to set the value of the sequence
generator on the master, it cannot be used in subqueries to update records
on distributed table data.</li>
<li class="li" id="topic1__cc149515"><code class="ph codeph">nextval()</code> sometimes grabs a block of values from the
master for a segment to use, depending on the query. So values may sometimes
be skipped in the sequence if all of the block turns out not to be needed
at the segment level. Note that a regular PostgreSQL database does this
too, so this is not something unique to Greenplum Database.</li>
</ul>
<p class="p">Although you cannot update a sequence directly, you can use a query like:</p>
<pre class="pre codeblock"><code>SELECT * FROM &lt;sequence_name&gt;;</code></pre><p class="p">to examine the parameters and current state of a sequence. In particular,
the <var class="keyword varname">last_value</var> field of the sequence shows the last value allocated
by any session.</p>
</div>
<div class="section" id="topic1__section4"><h2 class="title sectiontitle">Parameters</h2><dl class="dl parml"><dt class="dt pt dlterm">TEMPORARY | TEMP</dt>
<dd class="dd pd">If specified, the sequence object is created only for this session,
and is automatically dropped on session exit. Existing permanent sequences
with the same name are not visible (in this session) while the temporary
sequence exists, unless they are referenced with schema-qualified names.
</dd>
<dt class="dt pt dlterm"><var class="keyword varname">name</var></dt>
<dd class="dd pd">The name (optionally schema-qualified) of the sequence to be created.
</dd>
<dt class="dt pt dlterm"><var class="keyword varname">increment</var></dt>
<dd class="dd pd">Specifies which value is added to the current sequence value to create
a new value. A positive value will make an ascending sequence, a negative
one a descending sequence. The default value is 1. </dd>
<dt class="dt pt dlterm"><var class="keyword varname">minvalue</var></dt>
<dt class="dt pt dlterm">NO MINVALUE</dt>
<dd class="dd pd">Determines the minimum value a sequence can generate. If this clause
is not supplied or <code class="ph codeph">NO MINVALUE</code> is specified, then defaults
will be used. The defaults are 1 and -263-1 for ascending and descending
sequences, respectively. </dd>
<dt class="dt pt dlterm"><var class="keyword varname">maxvalue</var></dt>
<dt class="dt pt dlterm">NO MAXVALUE</dt>
<dd class="dd pd">Determines the maximum value for the sequence. If this clause is
not supplied or <code class="ph codeph">NO MAXVALUE</code> is specified, then default
values will be used. The defaults are 263-1 and -1 for ascending and
descending sequences, respectively. </dd>
<dt class="dt pt dlterm"><var class="keyword varname">start</var></dt>
<dd class="dd pd">Allows the sequence to begin anywhere. The default starting value
is <var class="keyword varname">minvalue</var> for ascending sequences and <var class="keyword varname">maxvalue</var> for descending
ones. </dd>
<dt class="dt pt dlterm"><var class="keyword varname">cache</var></dt>
<dd class="dd pd">Specifies how many sequence numbers are to be preallocated and stored
in memory for faster access. The minimum (and default) value is 1 (no
cache). </dd>
<dt class="dt pt dlterm">CYCLE</dt>
<dt class="dt pt dlterm">NO CYCLE</dt>
<dd class="dd pd">Allows the sequence to wrap around when the <var class="keyword varname">maxvalue</var> (for
ascending) or <var class="keyword varname">minvalue</var> (for descending) has been reached. If the
limit is reached, the next number generated will be the <var class="keyword varname">minvalue</var>
(for ascending) or <var class="keyword varname">maxvalue</var> (for descending). If <code class="ph codeph">NO CYCLE</code>
is specified, any calls to <code class="ph codeph">nextval()</code> after the sequence
has reached its maximum value will return an error. If not specified,
<code class="ph codeph">NO CYCLE</code> is the default.</dd>
<dt class="dt pt dlterm">OWNED BY <var class="keyword varname">table.column</var></dt>
<dt class="dt pt dlterm">OWNED BY NONE</dt>
<dd class="dd pd">Causes the sequence to be associated with a specific table column,
such that if that column (or its whole table) is dropped, the sequence
will be automatically dropped as well. The specified table must have
the same owner and be in the same schema as the sequence. <code class="ph codeph">OWNED
BY NONE</code>, the default, specifies that there is no such association.</dd>
</dl>
</div>
<div class="section" id="topic1__section5"><h2 class="title sectiontitle">Notes</h2><p class="p">Sequences are based on bigint arithmetic, so the range cannot exceed
the range of an eight-byte integer (-9223372036854775808 to 9223372036854775807).</p>
<p class="p">Although multiple sessions are guaranteed to allocate distinct sequence
values, the values may be generated out of sequence when all the sessions
are considered. For example, session A might reserve values 1..10 and
return <code class="ph codeph">nextval=1</code>, then session B might reserve values
11..20 and return <code class="ph codeph">nextval=11</code> before session A has generated
nextval=2. Thus, you should only assume that the <code class="ph codeph">nextval()</code>
values are all distinct, not that they are generated purely sequentially.
Also, <var class="keyword varname">last_value</var> will reflect the latest value reserved by any
session, whether or not it has yet been returned by <code class="ph codeph">nextval()</code>.</p>
</div>
<div class="section" id="topic1__section6"><h2 class="title sectiontitle">Examples</h2><p class="p">Create a sequence named <var class="keyword varname">myseq</var>:</p>
<pre class="pre codeblock"><code>CREATE SEQUENCE myseq START 101;</code></pre><p class="p">Insert a row into a table that gets the next value of the sequence named <var class="keyword varname">idseq</var>:</p>
<pre class="pre codeblock"><code>INSERT INTO distributors VALUES (nextval('idseq'), 'acme'); </code></pre><p class="p">Reset the sequence counter value on the master:</p>
<pre class="pre codeblock"><code>SELECT setval('myseq', 201);</code></pre><p class="p">Illegal use of <code class="ph codeph">setval()</code> in Greenplum Database (setting
sequence values on distributed data):</p>
<pre class="pre codeblock"><code>INSERT INTO product VALUES (setval('myseq', 201), 'gizmo'); </code></pre></div>
<div class="section" id="topic1__section7"><h2 class="title sectiontitle">Compatibility</h2><p class="p"><code class="ph codeph">CREATE SEQUENCE</code> conforms to the SQL standard, with
the following exceptions: </p>
<ul class="ul"><li class="li" id="topic1__cc148458">The <code class="ph codeph">AS <var class="keyword varname">data_type</var></code> expression specified in the SQL standard
          is not supported. </li>
<li class="li" id="topic1__cc148460">Obtaining the next value is done using the <code class="ph codeph">nextval()</code>
function instead of the <code class="ph codeph">NEXT VALUE FOR</code> expression specified
in the SQL standard. </li>
<li class="li" id="topic1__cc148462">The <code class="ph codeph">OWNED BY</code> clause is a Greenplum Database extension.
</li>
</ul>
</div>
<div class="section" id="topic1__section8"><h2 class="title sectiontitle">See Also</h2><p class="p"><a class="xref" href="ALTER_SEQUENCE.html#topic1">ALTER SEQUENCE</a>,
            <a class="xref" href="DROP_SEQUENCE.html#topic1">DROP SEQUENCE</a></p>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../sql_commands/sql_ref.html">SQL Commands</a></div>
</div>
</div></body>
</html>