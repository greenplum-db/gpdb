<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="ALTER OPERATOR FAMILY" />
<meta name="DC.relation" scheme="URI" content="../sql_commands/sql_ref.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>ALTER OPERATOR FAMILY</title>
</head>
<body id="topic1">
<h1 class="title topictitle1" id="topic1__as20941">ALTER OPERATOR FAMILY</h1>
<div class="body"><p class="p" id="topic1__sql_command_desc">Changes the definition of an operator family.</p>
<div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2><pre class="pre codeblock" id="topic1__sql_command_synopsis"><code>ALTER OPERATOR FAMILY &lt;name&gt; USING &lt;index_method&gt; ADD
  {  OPERATOR &lt;strategy_number&gt; &lt;operator_name&gt; ( &lt;op_type&gt;, &lt;op_type&gt; ) [ FOR SEARCH | FOR ORDER BY &lt;sort_family_name&gt; ]
    | FUNCTION &lt;support_number&gt; [ ( &lt;op_type&gt; [ , &lt;op_type&gt; ] ) ] &lt;funcname&gt; ( &lt;argument_type&gt; [, ...] )
  } [, ... ]

ALTER OPERATOR FAMILY &lt;name&gt; USING &lt;index_method&gt; DROP
  {  OPERATOR &lt;strategy_number&gt; ( &lt;op_type&gt;, &lt;op_type&gt; ) 
    | FUNCTION &lt;support_number&gt; [ ( &lt;op_type&gt; [ , &lt;op_type&gt; ] ) 
  } [, ... ]

ALTER OPERATOR FAMILY &lt;name&gt; USING &lt;index_method&gt; RENAME TO &lt;new_name&gt;

ALTER OPERATOR FAMILY &lt;name&gt; USING &lt;index_method&gt; OWNER TO &lt;new_owner&gt;

ALTER OPERATOR FAMILY &lt;name&gt; USING &lt;index_method&gt; SET SCHEMA &lt;new_schema&gt;</code></pre></div>
<div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2><p class="p"><code class="ph codeph">ALTER OPERATOR FAMILY</code> changes the definition of an operator family. You can add
        operators and support functions to the family, remove them from the family, or change the
        family's name or owner.</p>

      <p class="p">When operators and support functions are added to a family with <code class="ph codeph">ALTER OPERATOR
          FAMILY</code>, they are not part of any specific operator class within the family, but
        are just "loose" within the family. This indicates that these operators and functions are
        compatible with the family's semantics, but are not required for correct functioning of any
        specific index. (Operators and functions that are so required should be declared as part of
        an operator class, instead; see <a class="xref" href="CREATE_OPERATOR_CLASS.html#topic1">CREATE OPERATOR CLASS</a>.) You can drop loose members of a family  from the family at any time, but
        members of an operator class cannot be dropped without dropping the whole class and any
        indexes that depend on it. Typically, single-data-type operators and functions are part of
        operator classes because they are needed to support an index on that specific data type,
        while cross-data-type operators and functions are made loose members of the family.</p>

      <p class="p">You must be a superuser to use <code class="ph codeph">ALTER OPERATOR FAMILY</code>. (This restriction is
        made because an erroneous operator family definition could confuse or even crash the
        server.)</p>

      <p class="p"><code class="ph codeph">ALTER OPERATOR FAMILY</code> does not presently check whether the operator family
        definition includes all the operators and functions required by the index method, nor
        whether the operators and functions form a self-consistent set. It is the user's
        responsibility to define a valid operator family.</p>

      <p class="p"><code class="ph codeph">OPERATOR</code> and <code class="ph codeph">FUNCTION</code> clauses can appear in any
        order.</p>
</div>
<div class="section" id="topic1__section4"><h2 class="title sectiontitle">Parameters</h2><dl class="dl parml"><dt class="dt pt dlterm"><var class="keyword varname">name</var></dt>
<dd class="dd pd">The name (optionally schema-qualified) of an existing operator family. </dd>
<dt class="dt pt dlterm"><var class="keyword varname">index_method</var></dt>
<dd class="dd pd">The name of the index method this operator family is for. </dd>

        
          <dt class="dt pt dlterm"><var class="keyword varname">strategy_number</var></dt>

          <dd class="dd pd">The index method's strategy number for an operator associated with the operator
            family.</dd>

        
        
          <dt class="dt pt dlterm"><var class="keyword varname">operator_name</var></dt>

          <dd class="dd pd">The name (optionally schema-qualified) of an operator associated with the operator
            family.</dd>

        
        
          <dt class="dt pt dlterm">op_type</dt>

          <dd class="dd pd">In an  <code class="ph codeph">OPERATOR</code> clause, the operand data type(s) of the operator, or
              <code class="ph codeph">NONE</code> to signify a left-unary or right-unary operator. Unlike the
            comparable syntax in <code class="ph codeph">CREATE OPERATOR CLASS</code>, the operand data types must
            always be specified. In an <code class="ph codeph">ADD FUNCTION</code> clause, the operand data type(s)
            the function is intended to support, if different from the input data type(s) of the
            function. For B-tree comparison functions it is not necessary to specify <var class="keyword varname">op_type</var> since the
            function's input data type(s) are always the correct ones to use.  For B-tree sort
            support functions and all functions in GiST, SP-GiST, and GIN operator
            classes, it is necessary to specify the operand data type(s) the function
            is to be used with.</dd>
 
        
        
          <dt class="dt pt dlterm"><var class="keyword varname">sort_family_name</var></dt>

          <dd class="dd pd">The name (optionally schema-qualified) of an existing <code class="ph codeph">btree</code> operator
            family that describes the sort ordering associated with an ordering operator.
          </dd>

          <dd class="dd pd ddexpand">If neither <code class="ph codeph">FOR SEARCH</code> nor <code class="ph codeph">FOR ORDER BY</code> is
            specified, <code class="ph codeph">FOR SEARCH</code> is the default.</dd>

        
        
          <dt class="dt pt dlterm">support_number</dt>

          <dd class="dd pd">The index method's support procedure number for a function associated with the
            operator family.</dd>

        
        
          <dt class="dt pt dlterm">funcname</dt>

          <dd class="dd pd">The name (optionally schema-qualified) of a function that is an index method support
            procedure for the operator family.</dd>

        
        
          <dt class="dt pt dlterm">argument_types</dt>

          <dd class="dd pd">The parameter data type(s) of the function.</dd>

        <dt class="dt pt dlterm"><var class="keyword varname">new_name</var></dt>
<dd class="dd pd">The new name of the operator family. </dd>
<dt class="dt pt dlterm"><var class="keyword varname">new_owner</var></dt>
<dd class="dd pd">The new owner of the operator family. </dd>

        
          <dt class="dt pt dlterm"><var class="keyword varname">new_schema</var></dt>

          <dd class="dd pd">The new schema for the operator family. </dd>

        </dl>
</div>
<div class="section" id="topic1__section5"><h2 class="title sectiontitle">Compatibility</h2><p class="p">There is no <code class="ph codeph">ALTER OPERATOR FAMILY</code> statement in the SQL standard. </p>
</div>

    <div class="section" id="topic1__section6"><h2 class="title sectiontitle">Notes</h2>
      
      <p class="p">Notice that the <code class="ph codeph">DROP</code> syntax only specifies the "slot" in the operator
        family, by strategy or support number and input data type(s). The name of the operator or
        function occupying the slot is not mentioned. Also, for <code class="ph codeph">DROP FUNCTION</code> the
        type(s) to specify are the input data type(s) the function is intended to support; for
          <code class="ph codeph">GiST</code>, <code class="ph codeph">SP_GiST</code>, and <code class="ph codeph">GIN</code> indexes this
        might have nothing to do with the actual input argument types of the function. </p>

      <p class="p">Because the index machinery does not check access permissions on functions before using
        them, including a function or operator in an operator family is tantamount to granting
        public execute permission on it. This is usually not an issue for the sorts of functions
        that are useful in an operator family.</p>

      <p class="p">The operators should not be defined by SQL functions. A SQL function is likely to be
        inlined into the calling query, which will prevent the optimizer from recognizing that the
        query matches an index.</p>

      <p class="p">Before Greenplum Database 6.0, the <code class="ph codeph">OPERATOR</code> clause could include a
          <code class="ph codeph">RECHECK</code> option. This option is no longer supported. Greenplum Database
        now determines whether an index operator is "lossy" on-the-fly at run time. This allows more
        efficient handling of cases where an operator might or might not be lossy.</p>

    </div>

    <div class="section" id="topic1__section7"><h2 class="title sectiontitle">Examples</h2>
      
      <p class="p">The following example command adds cross-data-type operators and support functions to an
        operator family that already contains B-tree operator classes for data types int4 and int2.: </p>

      <pre class="pre codeblock"><code>ALTER OPERATOR FAMILY integer_ops USING btree ADD

  -- int4 vs int2
  OPERATOR 1 &lt; (int4, int2) ,
  OPERATOR 2 &lt;= (int4, int2) ,
  OPERATOR 3 = (int4, int2) ,
  OPERATOR 4 &gt;= (int4, int2) ,
  OPERATOR 5 &gt; (int4, int2) ,
  FUNCTION 1 btint42cmp(int4, int2) ,

  -- int2 vs int4
  OPERATOR 1 &lt; (int2, int4) ,
  OPERATOR 2 &lt;= (int2, int4) ,
  OPERATOR 3 = (int2, int4) ,
  OPERATOR 4 &gt;= (int2, int4) ,
  OPERATOR 5 &gt; (int2, int4) ,
  FUNCTION 1 btint24cmp(int2, int4) ;</code></pre>
    </div>

    <div class="p">To remove these entries:
      <pre class="pre codeblock"><code>ALTER OPERATOR FAMILY integer_ops USING btree DROP

  -- int4 vs int2
  OPERATOR 1 (int4, int2) ,
  OPERATOR 2 (int4, int2) ,
  OPERATOR 3 (int4, int2) ,
  OPERATOR 4 (int4, int2) ,
  OPERATOR 5 (int4, int2) ,
  FUNCTION 1 (int4, int2) ,

  -- int2 vs int4
  OPERATOR 1 (int2, int4) ,
  OPERATOR 2 (int2, int4) ,
  OPERATOR 3 (int2, int4) ,
  OPERATOR 4 (int2, int4) ,
  OPERATOR 5 (int2, int4) ,
  FUNCTION 1 (int2, int4) ;</code></pre></div>
<div class="section" id="topic1__section8"><h2 class="title sectiontitle">See Also</h2><p class="p"><a class="xref" href="CREATE_OPERATOR_FAMILY.html#topic1">CREATE OPERATOR FAMILY</a>,
            <a class="xref" href="DROP_OPERATOR_FAMILY.html#topic1">DROP OPERATOR FAMILY</a>, <a class="xref" href="ALTER_OPERATOR_CLASS.html#topic1">ALTER OPERATOR CLASS</a>, <a class="xref" href="CREATE_OPERATOR_CLASS.html#topic1">CREATE OPERATOR CLASS</a>, <a class="xref" href="DROP_OPERATOR_CLASS.html#topic1">DROP OPERATOR CLASS</a></p>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../sql_commands/sql_ref.html">SQL Commands</a></div>
</div>
</div></body>
</html>