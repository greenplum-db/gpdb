<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="orafce" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<meta name="DC.language" content="en" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>orafce</title>
</head>
<body id="topic1">

  <h1 class="title topictitle1" id="topic1__me143671">orafce</h1>

  <div class="body">
    <p class="p">The <code class="ph codeph">orafce</code> module provides Oracle Compatibility SQL functions
      in Greenplum Database. These functions target PostgreSQL but can also be used
      in Greenplum.</p>

    <p class="p">The Greenplum Database <code class="ph codeph">orafce</code> module is a modified version of the
      <a class="xref" href="https://github.com/orafce/orafce" target="_blank">open source Orafce PostgreSQL module extension</a>.
      The modified <code class="ph codeph">orafce</code> source files for Greenplum Database
      can be found in the <code class="ph codeph">gpcontrib/orafce</code> directory in the <a class="xref" href="https://github.com/greenplum-db/gpdb" target="_blank">Greenplum
      Database open source project</a>. The source reflects the Orafce 3.6.1 release and
      additional commits to <a class="xref" href="https://github.com/orafce/orafce/tree/3af70a28f6ab81f43c990fb5661df99a37328b8a" target="_blank">3af70a28f6</a>.</p>

     <p class="p">There are some restrictions and limitations when you use the module in Greenplum
       Database.</p>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title2" id="topic_reg">
    <h2 class="title topictitle2" id="ariaid-title2">Installing and Registering the Module</h2>

    <div class="body">
      <div class="note"><span class="notetitle">Note:</span> Always use the Oracle Compatibility Functions module included with your Greenplum
        Database version. Before upgrading to a new Greenplum Database version, uninstall the
        compatibility functions from each of your databases, and then, when the upgrade is complete,
        reinstall the compatibility functions from the new Greenplum Database release. See the
        Greenplum Database release notes for upgrade prerequisites and procedures.</div>

      <p class="p">The <code class="ph codeph">orafce</code> module is installed when you install
        Greenplum Database. Before you can use any of the functions defined in the
        module, you must register the <code class="ph codeph">orafce</code> extension in
        each database in which you want to use the functions.
        <span class="ph">Refer to <a class="xref" href="../../install_guide/install_modules.html" target="_blank">Installing Additional Supplied Modules</a>
        for more information.</span></p>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title3" id="topic_mpp">
    <h2 class="title topictitle2" id="ariaid-title3">Greenplum Database Considerations</h2>

    <div class="body">
    <p class="p">The following functions are available by default in Greenplum Database and do not require
      installing the Oracle Compatibility Functions:</p>

      <ul class="ul">
        <li class="li">sinh()</li>

        <li class="li">tanh()</li>

        <li class="li">cosh()</li>

        <li class="li">decode() (See <a class="xref" href="#topic3">Greenplum Implementation Differences</a> for more information.)</li>

      </ul>

    </div>

  <div class="topic nested2" aria-labelledby="ariaid-title4" xml:lang="en" lang="en" id="topic3">
    <h3 class="title topictitle3" id="ariaid-title4">Greenplum Implementation Differences</h3>

    <div class="body">
      <p class="p">There are differences in the implementation of the compatibility functions in
        Greenplum Database from the original PostgreSQL <code class="ph codeph">orafce</code> module
        extension implementation.  Some of the differences are as follows:</p>

      <ul class="ul">
        <li class="li" id="topic3__me144138">The original <code class="ph codeph">orafce</code>
          module implementation performs a decimal round off, the Greenplum
          Database implementation does not:<ul class="ul" id="topic3__ul_yt5_bz1_1p">
            <li class="li">2.00 becomes 2 in the original module implementation</li>

            <li class="li">2.00 remains 2.00 in the Greenplum Database implementation</li>

          </ul>
</li>

        <li class="li" id="topic3__me144139">The provided Oracle compatibility functions handle
          implicit type conversions differently. For example, using the <code class="ph codeph">decode</code>
            function:<pre class="pre codeblock"><code>decode(&lt;expression&gt;, &lt;value&gt;, &lt;return&gt; [,&lt;value&gt;, &lt;return&gt;]...
            [, default])</code></pre><p class="p">The original <code class="ph codeph">orafce</code> module
            implementation
            automatically converts <var class="keyword varname">expression</var> and each <var class="keyword varname">value</var>
            to the data type of the first <var class="keyword varname">value</var> before comparing. It
            automatically converts <var class="keyword varname">return</var> to the same data type as the first
            result. </p>
<p class="p">The Greenplum Database implementation restricts <var class="keyword varname">return</var>
            and <code class="ph codeph">default</code> to be of the same data
            type. The <var class="keyword varname">expression</var> and <var class="keyword varname">value</var> can be different
            types if the data type of <var class="keyword varname">value</var> can be converted into the data type
            of the <var class="keyword varname">expression</var>. This is done implicitly. Otherwise, <code class="ph codeph">decode</code> fails with an <code class="ph codeph">invalid input syntax</code> error. For
          example:</p>
<pre class="pre codeblock"><code>SELECT decode('a','M',true,false);
CASE
------
 f
(1 row)
SELECT decode(1,'M',true,false);
ERROR: Invalid input syntax for integer:<em class="ph i">"M" 
</em>LINE 1: SELECT decode(1,'M',true,false);</code></pre></li>

        <li class="li" id="topic3__me144144">Numbers in <code class="ph codeph">bigint</code> format are displayed in scientific notation in the original
         <code class="ph codeph">orafce</code> module implementation but not in the
          Greenplum Database implementation:<ul class="ul" id="topic3__ul_cld_kz1_1p">
            <li class="li">9223372036854775 displays as 9.2234E+15 in the original implementation</li>

            <li class="li">9223372036854775 remains 9223372036854775 in the Greenplum Database implementation</li>

          </ul>
</li>

        <li class="li" id="topic3__me144146">The default date and timestamp format in the
          original <code class="ph codeph">orafce</code> module implementation is
          different than the default format in the Greenplum Database implementation. If
          the following code is
            run:<pre class="pre codeblock"><code>CREATE TABLE TEST(date1 date, time1 timestamp, time2 
                  timestamp with time zone);
INSERT INTO TEST VALUES ('2001-11-11','2001-12-13 
                 01:51:15','2001-12-13 01:51:15 -08:00');
SELECT DECODE(date1, '2001-11-11', '2001-01-01') FROM TEST;</code></pre><p class="p"> The Greenplum
            Database implementation returns the row, but the original implementation returns
            no rows.</p>
<div class="note"><span class="notetitle">Note:</span> The correct syntax when using
            the original <code class="ph codeph">orafce</code> implementation to return the row
            is:<pre class="pre codeblock"><code>SELECT DECODE(to_char(date1, 'YYYY-MM-DD'), '2001-11-11', 
              '2001-01-01') FROM TEST</code></pre></div>
</li>

        <li class="li">The functions in the Oracle Compatibility Functions <code class="ph codeph">dbms_alert</code> package
          are not implemented for Greenplum Database.</li>

        <li class="li">The <code class="ph codeph">decode()</code> function is removed from the Greenplum Database Oracle
          Compatibility Functions. The Greenplum Database parser internally converts a
          <code class="ph codeph">decode()</code> function call to a <code class="ph codeph">CASE</code> statement.</li>

      </ul>

    </div>

   </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title5" id="topic_using">
    <h2 class="title topictitle2" id="ariaid-title5">Using orafce</h2>

    <div class="body">
      <div class="p">Some Oracle Compatibility Functions reside in the
          <code class="ph codeph">oracle</code> schema. To access them, set the
        search path for the database to include the <code class="ph codeph">oracle</code> schema name. For
        example, this command sets the default search path for a database to include the
          <code class="ph codeph">oracle</code>
        schema:<pre class="pre codeblock"><code>ALTER DATABASE &lt;db_name&gt; SET &lt;search_path&gt; = "$user", public, oracle;</code></pre></div>

      <p class="p">Note the following differences when using the Oracle Compatibility Functions
        with PostgreSQL vs. using them with Greenplum Database: </p>

      <ul class="ul" id="topic_using__ul_njs_p4l_4gb">
        <li class="li">If you use validation scripts, the output may not be exactly the same as
          with the original <code class="ph codeph">orafce</code> module implementation.</li>

        <li class="li">The functions in the Oracle Compatibility Functions <code class="ph codeph">dbms_pipe</code> package
          run only on the Greenplum Database master host.</li>

        <li class="li">The upgrade scripts in the Orafce project do not work with Greenplum Database.</li>

      </ul>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title6" id="topic_info">
    <h2 class="title topictitle2" id="ariaid-title6">Additional Module Documentation</h2>

    <div class="body">
      <p class="p">Refer to the
         <a class="xref" href="https://github.com/greenplum-db/gpdb/tree/master/gpcontrib/orafce/README.asciidoc" target="_blank">README</a> and <a class="xref" href="https://github.com/greenplum-db/gpdb/tree/master/gpcontrib/orafce/doc/orafce_documentation" target="_blank">Greenplum
      Database orafce documentation</a> in the Greenplum Database github repository
        for detailed information about the individual functions and supporting
        objects provided in this module.</p>

    </div>

  </div>

</body>
</html>