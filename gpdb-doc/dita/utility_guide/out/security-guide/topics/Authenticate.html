<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="Configuring Client Authentication" />
<meta name="abstract" content="Describes the available methods for authenticating Greenplum Database clients." />
<meta name="description" content="Describes the available methods for authenticating Greenplum Database clients." />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic_n5w_gtd_jr" />
<link rel="stylesheet" type="text/css" href="../../out/commonltr.css" />
<title>Configuring Client Authentication</title>
</head>
<body id="topic_n5w_gtd_jr">

  <h1 class="title topictitle1" id="ariaid-title1">Configuring Client Authentication</h1>

  
  <div class="body"><p class="shortdesc">Describes the available methods for authenticating Greenplum Database
    clients.</p>

    <div class="p">When a Greenplum Database system is first initialized, the system contains one predefined
      superuser role. This role will have the same name as the operating system user who initialized
      the Greenplum Database system. This role is referred to as gpadmin. By default, the system is
      configured to only allow local connections to the database from the gpadmin role. If you want
      to allow any other roles to connect, or if you want to allow connections from remote hosts,
      you have to configure Greenplum Database to allow such connections. This section explains how
      to configure client connections and authentication to Greenplum Database.<ul class="ul" id="topic_n5w_gtd_jr__ul_kpg_sgq_kr">
        <li class="li"><a class="xref" href="#topic_ln1_ptd_jr">Allowing Connections to Greenplum Database</a></li>

        <li class="li"><a class="xref" href="#topic_xwr_rvd_jr">Editing the pg_hba.conf File</a></li>

        <li class="li"><a class="xref" href="#topic_nyh_gwd_jr">Authentication Methods</a></li>

        <li class="li"><a class="xref" href="#topic_hwn_bk2_jr">Limiting Concurrent Connections</a></li>

        <li class="li"><a class="xref" href="#topic_ibc_nl2_jr">Encrypting Client/Server Connections</a></li>

      </ul>
</div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title2" id="topic_ln1_ptd_jr">
    <h2 class="title topictitle2" id="ariaid-title2">Allowing Connections to Greenplum Database</h2>

    <div class="body">
      <p class="p">Client access and authentication is controlled by a configuration file named
          <code class="ph codeph">pg_hba.conf</code> (the standard PostgreSQL host-based authentication file). For
        detailed information about this file, see <a class="xref" href="https://www.postgresql.org/docs/9.4/auth-pg-hba-conf.html" target="_blank">The pg_hba.conf File</a> in the PostgreSQL documentation. </p>

      <p class="p">In Greenplum Database, the <code class="ph codeph">pg_hba.conf</code> file of the master instance
        controls client access and authentication to your Greenplum system. The segments also have
          <code class="ph codeph">pg_hba.conf</code> files, but these are already correctly configured to only
        allow client connections from the master host. The segments never accept outside client
        connections, so there is no need to alter the <code class="ph codeph">pg_hba.conf</code> file on segments. </p>

      <p class="p">The general format of the <code class="ph codeph">pg_hba.conf</code> file is a set of records, one per
        line. Blank lines are ignored, as is any text after a # comment character. A record is made
        up of a number of fields which are separated by spaces and/or tabs. Fields can contain white
        space if the field value is quoted. Records cannot be continued across lines. </p>

      <div class="p">A record can have one of seven formats:
        <pre class="pre codeblock"><code>local      &lt;database&gt;  &lt;user&gt;  &lt;auth-method&gt;  [&lt;auth-options&gt;]
host       &lt;database&gt;  &lt;user&gt;  &lt;address&gt;  &lt;auth-method&gt;  [&lt;auth-options&gt;]
hostssl    &lt;database&gt;  &lt;user&gt;  &lt;address&gt;  &lt;auth-method&gt;  [&lt;auth-options&gt;]
hostnossl  &lt;database&gt;  &lt;user&gt;  &lt;address&gt;  &lt;auth-method&gt;  [&lt;auth-options&gt;]
host       &lt;database&gt;  &lt;user&gt;  &lt;IP-address&gt;  &lt;IP-mas&gt;k  &lt;auth-method&gt;  [&lt;auth-options&gt;]
hostssl    &lt;database&gt;  &lt;user&gt;  &lt;IP-address&gt;  &lt;IP-mask&gt;  &lt;auth-method&gt;  [&lt;auth-options&gt;]
hostnossl  &lt;database&lt;  &lt;user&gt;  &lt;IP-address&gt;  &lt;IP-mask&gt;  &lt;auth-method&gt;  [&lt;auth-options&gt;]</code></pre></div>

      <div class="p">The meaning of the <code class="ph codeph">pg_hba.conf</code> fields is as follows: <dl class="dl parml">
          
            <dt class="dt pt dlterm"><code class="ph codeph">local</code></dt>

            <dd class="dd pd">Matches connection attempts using UNIX-domain sockets. Without a record of this
              type, UNIX-domain socket connections are disallowed. </dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">host</code></dt>

            <dd class="dd pd">Matches connection attempts made using TCP/IP. Remote TCP/IP connections will not be
              possible unless the server is started with an appropriate value for the
                <code class="ph codeph">listen_addresses</code> server configuration parameter. Greenplum Database
              by default allows connections from all hosts (<code class="ph codeph">'*'</code>).</dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">hostssl</code></dt>

            <dd class="dd pd">Matches connection attempts made using TCP/IP, but only when the connection is made
              with SSL encryption. SSL must be enabled at server start time by setting the
                <code class="ph codeph">ssl</code> configuration parameter to on. Requires SSL authentication be
              configured in <code class="ph codeph">postgresql.conf</code>. See <a class="xref" href="#topic_fzv_wb2_jr__ssl_postgresql">Configuring postgresql.conf for SSL Authentication</a>. </dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">hostnossl</code></dt>

            <dd class="dd pd"> Matches connection attempts made over TCP/IP that do not use SSL. </dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">database</code></dt>

            <dd class="dd pd">Specifies which database names this record matches. The value <code class="ph codeph">all</code>
              specifies that it matches all databases. Multiple database names can be supplied by
              separating them with commas. A separate file containing database names can be
              specified by preceding the file name with <code class="ph codeph">@</code>. </dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">user</code></dt>

            <dd class="dd pd">Specifies which database role names this record matches. The value
                <code class="ph codeph">all</code> specifies that it matches all roles. If the specified role is a
              group and you want all members of that group to be included, precede the role name
              with a <code class="ph codeph">+</code>. Multiple role names can be supplied by separating them with
              commas. A separate file containing role names can be specified by preceding the file
              name with <code class="ph codeph">@</code>. </dd>

          
          
            <dt class="dt pt dlterm">
              <code class="ph codeph">address</code>
            </dt>

            <dd class="dd pd">Specifies the client machine addresses that this record matches. This field can
              contain either a host name, an IP address range, or one of the special key words
              mentioned below. </dd>

            <dd class="dd pd ddexpand">An IP address range is specified using standard numeric notation for the range's
              starting address, then a slash (<code class="ph codeph">/</code>) and a CIDR mask length. The mask
              length indicates the number of high-order bits of the client IP address that must
              match. Bits to the right of this should be zero in the given IP address. There must
              not be any white space between the IP address, the <code class="ph codeph">/</code>, and the CIDR
              mask length.</dd>

            <dd class="dd pd ddexpand">Typical examples of an IPv4 address range specified this way are
                <code class="ph codeph">172.20.143.89/32</code> for a single host, or
                <code class="ph codeph">172.20.143.0/24</code> for a small network, or
                <code class="ph codeph">10.6.0.0/16</code> for a larger one. An IPv6 address range might look like
                <code class="ph codeph">::1/128</code> for a single host (in this case the IPv6 loopback address)
              or <code class="ph codeph">fe80::7a31:c1ff:0000:0000/96</code> for a small network.
                <code class="ph codeph">0.0.0.0/0</code> represents all IPv4 addresses, and <code class="ph codeph">::0/0</code>
              represents all IPv6 addresses. To specify a single host, use a mask length of 32 for
              IPv4 or 128 for IPv6. In a network address, do not omit trailing zeroes.</dd>

            <dd class="dd pd ddexpand">An entry given in IPv4 format will match only IPv4 connections, and an entry given
              in IPv6 format will match only IPv6 connections, even if the represented address is in
              the IPv4-in-IPv6 range. <div class="note"><span class="notetitle">Note:</span> Entries in IPv6 format will be rejected if the host
                system C library does not have support for IPv6 addresses.</div>
</dd>

            <dd class="dd pd ddexpand">You can also write <code class="ph codeph">all</code> to match any IP address,
                <code class="ph codeph">samehost</code> to match any of the server's own IP addresses, or
                <code class="ph codeph">samenet</code> to match any address in any subnet to which the server is
              directly connected.</dd>

            <dd class="dd pd ddexpand">If a host name is specified (an address that is not an IP
              address, IP range, or special key word is treated as a host name), that name is
              compared with the result of a reverse name resolution of the client IP address (for
              example, reverse DNS lookup, if DNS is used). Host name comparisons are case
              insensitive. If there is a match, then a forward name resolution (for example, forward
              DNS lookup) is performed on the host name to check whether any of the addresses it
              resolves to are equal to the client IP address. If both directions match, then the
              entry is considered to match. </dd>

            <dd class="dd pd ddexpand">The host name that is used in <code class="ph codeph">pg_hba.conf</code> should be the one that
              address-to-name resolution of the client's IP address returns, otherwise the line
              won't be matched. Some host name databases allow associating an IP address with
              multiple host names, but the operating system will only return one host name when
              asked to resolve an IP address.</dd>

            <dd class="dd pd ddexpand">A host name specification that starts with a dot (.) matches a suffix of the actual
              host name. So <code class="ph codeph">.example.com</code> would match
                <code class="ph codeph">foo.example.com</code> (but not just <code class="ph codeph">example.com</code>).</dd>

            <dd class="dd pd ddexpand">When host names are specified in <code class="ph codeph">pg_hba.conf</code>, you should ensure
              that name resolution is reasonably fast. It can be advantageous to set up a local name
              resolution cache such as <code class="ph codeph">nscd</code>. Also, you can enable the server
              configuration parameter <code class="ph codeph">log_hostname</code> to see the client host name
              instead of the IP address in the log. </dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">IP-address</code></dt>

            <dt class="dt pt dlterm"><code class="ph codeph">IP-mask</code>
            </dt>

            <dd class="dd pd">These two fields can be used as an alternative to the CIDR address notation. Instead
              of specifying the mask length, the actual mask is specified in a separate column. For
              example, <code class="ph codeph">255.0.0.0</code> represents an IPv4 CIDR mask length of 8, and
                <code class="ph codeph">255.255.255.255</code> represents a CIDR mask length of 32. </dd>

          
          
            <dt class="dt pt dlterm">
              <code class="ph codeph">auth-method</code>
            </dt>

            <dd class="dd pd"> Specifies the authentication method to use when a connection matches this record.
              See <a class="xref" href="#topic_nyh_gwd_jr">Authentication Methods</a> for options. </dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">auth-options</code></dt>

            <dd class="dd pd">After the <code class="ph codeph">auth-method</code> field, there can be field(s) of the form
                <var class="keyword varname">name=value</var> that specify options for the authentication method.
              Details about which options are available for which authentication methods are
              described in <a class="xref" href="#topic_nyh_gwd_jr">Authentication Methods</a>.</dd>

          
        </dl>
</div>

      <p class="p">Files included by @ constructs are read as lists of names, which can be separated by either
        whitespace or commas. Comments are introduced by #, just as in <code class="ph codeph">pg_hba.conf</code>,
        and nested @ constructs are allowed. Unless the file name following @ is an absolute path,
        it is taken to be relative to the directory containing the referencing file.</p>

      <p class="p">The <code class="ph codeph">pg_hba.conf</code> records are examined sequentially for each connection
        attempt, so the order of the records is significant. Typically, earlier records will have
        tight connection match parameters and weaker authentication methods, while later records
        will have looser match parameters and stronger authentication methods. For example, you
        might wish to use <code class="ph codeph">trust</code> authentication for local TCP/IP connections but require a password
        for remote TCP/IP connections. In this case a record specifying <code class="ph codeph">trust</code> authentication for
        connections from 127.0.0.1 would appear before a record specifying <code class="ph codeph">password</code> authentication
        for a wider range of allowed client IP addresses.</p>

      <div class="p">The <code class="ph codeph">pg_hba.conf</code> file is read on start-up and when the main server process
        receives a SIGHUP signal. If you edit the file on an active system, you must reload the file
        using this command:<pre class="pre codeblock"><code>$ gpstop -u</code></pre></div>

      <div class="cautiontitle">CAUTION:</div><div class="note caution">For a more secure system, remove records for remote connections that use
        <code class="ph codeph">trust</code> authentication from the <code class="ph codeph">pg_hba.conf</code> file. <code class="ph codeph">trust</code> authentication grants
        any user who can connect to the server access to the database using any role they specify.
        You can safely replace <code class="ph codeph">trust</code> authentication with <code class="ph codeph">ident</code> authentication for local UNIX-socket
        connections. You can also use <code class="ph codeph">ident</code> authentication for local and remote TCP clients, but the
        client host must be running an ident service and you must <code class="ph codeph">trust</code> the integrity of that
        machine.</div>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title3" id="topic_xwr_rvd_jr">
    <h2 class="title topictitle2" id="ariaid-title3">Editing the pg_hba.conf File</h2>

    <div class="body">
      <p class="p">Initially, the <code class="ph codeph">pg_hba.conf</code> file is set up with generous permissions for
        the gpadmin user and no database access for other Greenplum Database roles. You will need to
        edit the <code class="ph codeph">pg_hba.conf</code> file to enable users' access to databases and to
        secure the gpadmin user. Consider removing entries that have <code class="ph codeph">trust</code> authentication, since
        they allow anyone with access to the server to connect with any role they choose. For local
        (UNIX socket) connections, use <code class="ph codeph">ident</code> authentication, which requires the operating system
        user to match the role specified. For local and remote TCP connections, <code class="ph codeph">ident</code> authentication
        requires the client's host to run an indent service. You could install an ident service on
        the master host and then use <code class="ph codeph">ident</code> authentication for local TCP connections, for example
          <code class="ph codeph">127.0.0.1/28</code>. Using <code class="ph codeph">ident</code> authentication for remote TCP connections is
        less secure because it requires you to trust the integrity of the ident service on the
        client's host. </p>

      <div class="note"><span class="notetitle">Note:</span>  Greenplum Command Center provides an interface for editing the
          <code class="ph codeph">pg_hba.conf</code> file. It verifies entries before you save them, keeps a
        version history of the file so that you can reload a previous version of the file, and
        reloads the file into Greenplum Database. </div>

      <p class="p">This example shows how to edit the <code class="ph codeph">pg_hba.conf</code> file on the master host to
        allow remote client access to all databases from all roles using encrypted password
        authentication. </p>

      <div class="p">To edit <code class="ph codeph">pg_hba.conf</code>:<ol class="ol" id="topic_xwr_rvd_jr__ol_krz_zvd_jr">
          <li class="li">Open the file <code class="ph codeph">$MASTER_DATA_DIRECTORY/pg_hba.conf</code> in a text
            editor.</li>

          <li class="li">Add a line to the file for each type of connection you want to allow. Records are read
            sequentially, so the order of the records is significant. Typically, earlier records
            will have tight connection match parameters and weaker authentication methods, while
            later records will have looser match parameters and stronger authentication methods. For
            example:<pre class="pre codeblock"><code># allow the gpadmin user local access to all databases
# using ident authentication
local   all   gpadmin   ident         sameuser
host    all   gpadmin   127.0.0.1/32  ident
host    all   gpadmin   ::1/128       ident
# allow the 'dba' role access to any database from any
# host with IP address 192.168.x.x and use md5 encrypted
# passwords to authenticate the user
# Note that to use SHA-256 encryption, replace md5 with
# password in the line below
host    all   dba   192.168.0.0/32  md5</code></pre></li>

        </ol>
</div>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title4" id="topic_nyh_gwd_jr">
    <h2 class="title topictitle2" id="ariaid-title4">Authentication Methods</h2>

    <div class="body">
      <ul class="ul" id="topic_nyh_gwd_jr__ul_qgp_1jq_kr">
        <li class="li">
          <a class="xref" href="#topic_nyh_gwd_jr__basic_auth">Basic Authentication</a>
        </li>

        <li class="li">
          <a class="xref" href="#topic_nyh_gwd_jr__kerberos_auth">GSSAPI Authentication</a>
        </li>

        <li class="li">
          <a class="xref" href="#topic_nyh_gwd_jr__ldap_auth">LDAP Authentication</a>
        </li>

        <li class="li">
          <a class="xref" href="#topic_fzv_wb2_jr">SSL Client Authentication</a>
        </li>

        <li class="li">
          <a class="xref" href="#topic_yxp_5h2_jr">PAM-Based Authentication</a>
        </li>

        <li class="li">
          <a class="xref" href="#topic_ed4_d32_jr">Radius Authentication</a>
        </li>

      </ul>

      <div class="section" id="topic_nyh_gwd_jr__basic_auth"><h3 class="title sectiontitle">Basic Authentication</h3>
        
        <div class="p">
          <dl class="dl parml" id="topic_nyh_gwd_jr__ul_zsk_kwd_jr">
            
              <dt class="dt pt dlterm">Trust</dt>

              <dd class="dd pd">Allows the connection unconditionally, without the need for a password or any
                other authentication. This entry is required for the <code class="ph codeph">gpadmin</code> role,
                and for Greenplum utilities (for example <code class="ph codeph">gpinitsystem</code>,
                  <code class="ph codeph">gpstop</code>, or <code class="ph codeph">gpstart</code> amongst others) that need to
                connect between nodes without prompting for input or a password. </dd>

              <dd class="dd pd ddexpand">
                <div class="note important"><span class="importanttitle">Important:</span> For a more secure system, remove records for remote
                  connections that use <code class="ph codeph">trust</code> authentication from
                    the <code class="ph codeph">pg_hba.conf</code> file. <code class="ph codeph">trust</code> authentication
                  grants any user who can connect to the server access to the database using any
                  role they specify. You can safely replace <code class="ph codeph">trust</code> authentication
                  with <code class="ph codeph">ident</code> authentication for local UNIX-socket connections. You
                  can also use <code class="ph codeph">ident</code> authentication for local and remote TCP
                  clients, but the client host must be running an ident service and you must
                    <code class="ph codeph">trust</code> the integrity of that machine.</div>

              </dd>

            
            
              <dt class="dt pt dlterm">Reject</dt>

              <dd class="dd pd">Reject the connections with the matching parameters. You should typically use this
                to restrict access from specific hosts or insecure connections.</dd>

            
            
              <dt class="dt pt dlterm">Ident</dt>

              <dd class="dd pd">Authenticates based on the client's operating system user name. This is secure for
                local socket connections. Using <code class="ph codeph">ident</code> for TCP connections from remote hosts requires
                that the client's host is running an ident service. The <code class="ph codeph">ident</code> authentication method
                should only be used with remote hosts on a trusted, closed network. </dd>

            
            
              <dt class="dt pt dlterm">md5</dt>

              <dd class="dd pd">Require the client to supply a double-MD5-hashed password for authentication.
              </dd>

            
            
              <dt class="dt pt dlterm">password</dt>

              <dd class="dd pd">Require the client to supply an unencrypted password for authentication. Since the
                password is sent in clear text over the network, this should not be used on
                untrusted networks.</dd>

            
          </dl>

        </div>

        <p class="p">The password-based authentication methods are <code class="ph codeph">md5</code> and
            <code class="ph codeph">password</code>. These methods operate similarly except for the way that the
          password is sent across the connection: MD5-hashed and clear-text respectively. </p>

        <p class="p">If you are at all concerned about password "sniffing" attacks then <code class="ph codeph">md5</code>
          is preferred. Plain <code class="ph codeph">password</code> should always be avoided if possible. If the
          connection is protected by SSL encryption then <code class="ph codeph">password</code> can be used
          safely (although SSL certificate authentication might be a better choice if you are
          depending on using SSL).</p>

        <div class="p">Following are some sample <code class="ph codeph">pg_hba.conf</code> basic authentication
          entries:<pre class="pre codeblock"><code>hostnossl    all   all        0.0.0.0   reject
hostssl      all   testuser   0.0.0.0/0 md5
local        all   gpuser               ident</code></pre></div>

      </div>

      <p class="p">Or:</p>

      <pre class="pre codeblock"><code>
local    all           gpadmin         ident 
host     all           gpadmin         localhost      trust 
host     all           gpadmin         mdw            trust 
local    replication   gpadmin         ident 
host     replication   gpadmin         samenet       trust 
host     all           all             0.0.0.0/0     md5</code></pre>
      <div class="section" id="topic_nyh_gwd_jr__kerberos_auth"><h3 class="title sectiontitle">GSSAPI Authentication</h3>
        
        <p class="p">GSSAPI is an industry-standard protocol for secure authentication defined in RFC 2743.
          Greenplum Database supports GSSAPI with Kerberos authentication according to RFC 1964.
          GSSAPI provides automatic authentication (single sign-on) for systems that support it. The
          authentication itself is secure, but the data sent over the database connection will be
          sent unencrypted unless SSL is used.</p>

        <p class="p">The <code class="ph codeph">gss</code> authentication method is only available for TCP/IP
          connections.</p>

        <p class="p">When GSSAPI uses Kerberos, it uses a standard principal in the format
            <var class="keyword varname">servicename/hostname@realm</var>. The Greenplum Database server will accept
          any principal that is included in the keytab file used by the server, but care needs to be
          taken to specify the correct principal details when making the connection from the client
          using the <code class="ph codeph">krbsrvname</code> connection parameter. (See <a class="xref" href="https://www.postgresql.org/docs/9.4/libpq-connect.html#LIBPQ-PARAMKEYWORDS" target="_blank">Connection Parameter Key Words</a> in the PostgreSQL
          documentation.) In most environments, this parameter never needs to be changed. Some
          Kerberos implementations might require a different service name, such as Microsoft Active
          Directory, which requires the service name to be in upper case (POSTGRES).</p>

        <p class="p"><var class="keyword varname">hostname</var> is the fully qualified host name of the server machine. The
          service principal's realm is the preferred realm of the server machine.</p>

        <p class="p">Client principals must have their Greenplum Database user name as their first component,
          for example <code class="ph codeph">gpusername@realm</code>. Alternatively, you can use a user name
          mapping to map from the first component of the principal name to the database user name.
          By default, Greenplum Database does not check the realm of the client. If you have
          cross-realm authentication enabled and need to verify the realm, use the
            <code class="ph codeph">krb_realm</code> parameter, or enable <code class="ph codeph">include_realm</code> and use
          user name mapping to check the realm.</p>

        <p class="p">Make sure that your server keytab file is readable (and preferably only readable) by the
          <code class="ph codeph">gpadmin</code> server account. The location of the key file is specified by the <a class="xref" href="../../ref_guide/config_params/guc-list.html#krb_server_keyfile">krb_server_keyfile</a> configuration
          parameter. For security reasons, it is recommended to use a separate keytab just for the
          Greenplum Database server rather than opening up permissions on the system keytab
          file.</p>

        <p class="p">The keytab file is generated by the Kerberos software; see the Kerberos documentation for
          details. The following example is for MIT-compatible Kerberos 5 implementations:</p>

        <pre class="pre codeblock"><code>kadmin% <strong class="ph b">ank -randkey postgres/server.my.domain.org</strong>
kadmin% <strong class="ph b">ktadd -k krb5.keytab postgres/server.my.domain.org</strong></code></pre>
        <p class="p">When connecting to the database make sure you have a ticket for a principal matching the
          requested database user name. For example, for database user name <code class="ph codeph">fred</code>,
          principal <code class="ph codeph">fred@EXAMPLE.COM</code> would be able to connect. To also allow
          principal <code class="ph codeph">fred/users.example.com@EXAMPLE.COM</code>, use a user name map, as
          described in <a class="xref" href="https://www.postgresql.org/docs/9.4/auth-username-maps.html" target="_blank">User Name Maps</a> in the PostgreSQL documentation.</p>

        <p class="p">The following configuration options are supported for GSSAPI: </p>

        <dl class="dl parml">
          
            <dt class="dt pt dlterm"><code class="ph codeph">include_realm</code></dt>

            <dd class="dd pd">If set to 1, the realm name from the authenticated user principal is included in the
              system user name that is passed through user name mapping. This is the recommended
              configuration as, otherwise, it is impossible to differentiate users with the same
              username who are from different realms. The default for this parameter is 0 (meaning
              to not include the realm in the system user name) but may change to 1 in a future
              version of Greenplum Database. You can set it explicitly to avoid any issues when
              upgrading.</dd>

          
          
            <dt class="dt pt dlterm"><code class="ph codeph">map</code></dt>

            <dd class="dd pd">Allows for mapping between system and database user names. For a GSSAPI/Kerberos
              principal, such as <code class="ph codeph">username@EXAMPLE.COM</code> (or, less commonly,
                <code class="ph codeph">username/hostbased@EXAMPLE.COM</code>), the default user name used for
              mapping is <code class="ph codeph">username</code> (or <code class="ph codeph">username/hostbased</code>,
              respectively), unless <code class="ph codeph">include_realm</code> has been set to 1 (as
              recommended, see above), in which case <code class="ph codeph">username@EXAMPLE.COM</code> (or
                <code class="ph codeph">username/hostbased@EXAMPLE.COM</code>) is what is seen as the system
              username when mapping. </dd>

          
        </dl>

        <dl class="dl parml">
          
            <dt class="dt pt dlterm"><code class="ph codeph">krb_realm</code></dt>

            <dd class="dd pd">
              <p class="p">Sets the realm to match user principal names against. If this parameter is set,
                only users of that realm will be accepted. If it is not set, users of any realm can
                connect, subject to whatever user name mapping is done.</p>

            </dd>

          
        </dl>

      </div>

      <div class="section" id="topic_nyh_gwd_jr__ldap_auth"><h3 class="title sectiontitle">LDAP Authentication</h3>
        
        <p class="p">You can authenticate against an LDAP directory.</p>

        <ul class="ul">
          <li class="li">LDAPS and LDAP over TLS options encrypt the connection to the LDAP server.</li>

          <li class="li">The connection from the client to the server is not encrypted unless SSL is enabled.
            Configure client connections to use SSL to encrypt connections from the client.</li>

          <li class="li">To configure or customize LDAP settings, set the <code class="ph codeph">LDAPCONF</code> environment
            variable with the path to the <code class="ph codeph">ldap.conf</code> file and add this to the
              <code class="ph codeph">greenplum_path.sh</code> script.</li>

        </ul>

        <div class="p">Following are the recommended steps for configuring your system for LDAP authentication: <ol class="ol">
            <li class="li"> Set up the LDAP server with the database users/roles to be authenticated via
              LDAP.</li>

            <li class="li">On the database:<ol class="ol" type="a">
                <li class="li">Verify that the database users to be authenticated via LDAP exist on the
                  database. LDAP is only used for verifying username/password pairs, so the roles
                  should exist in the database.</li>

                <li class="li">Update the <code class="ph codeph">pg_hba.conf</code> file in the
                    <code class="ph codeph">$MASTER_DATA_DIRECTORY</code> to use LDAP as the authentication method
                  for the respective users. Note that the first entry to match the user/role in the
                    <code class="ph codeph">pg_hba.conf</code> file will be used as the authentication mechanism,
                  so the position of the entry in the file is important.</li>

                <li class="li">Reload the server for the <code class="ph codeph">pg_hba.conf</code> configuration settings to
                  take effect (<code class="ph codeph">gpstop -u</code>).</li>

              </ol>

            </li>

          </ol>
</div>

        <div class="p">Specify the following parameter <code class="ph codeph">auth-options</code>. <dl class="dl parml">
            
              <dt class="dt pt dlterm">ldapserver</dt>

              <dd class="dd pd">Names or IP addresses of LDAP servers to connect to. Multiple servers may be
                specified, separated by spaces.</dd>

            
            
              <dt class="dt pt dlterm">ldapprefix</dt>

              <dd class="dd pd">String to prepend to the user name when forming the DN to bind as, when doing
                simple bind authentication.</dd>

            
            
              <dt class="dt pt dlterm">ldapsuffix</dt>

              <dd class="dd pd">String to append to the user name when forming the DN to bind as, when doing
                simple bind authentication.</dd>

            
            
              <dt class="dt pt dlterm">ldapport</dt>

              <dd class="dd pd">Port number on LDAP server to connect to. If no port is specified, the LDAP
                library's default port setting will be used.</dd>

            
            
              <dt class="dt pt dlterm">ldaptls</dt>

              <dd class="dd pd">Set to 1 to make the connection between PostgreSQL and the LDAP server use TLS
                encryption. Note that this only encrypts the traffic to the LDAP server — the
                connection to the client will still be unencrypted unless SSL is used.</dd>

            
            
              <dt class="dt pt dlterm">ldapbasedn</dt>

              <dd class="dd pd">Root DN to begin the search for the user in, when doing search+bind
                authentication.</dd>

            
            
              <dt class="dt pt dlterm">ldapbinddn</dt>

              <dd class="dd pd">DN of user to bind to the directory with to perform the search when doing
                search+bind authentication.</dd>

            
            
              <dt class="dt pt dlterm">ldapbindpasswd</dt>

              <dd class="dd pd">Password for user to bind to the directory with to perform the search when doing
                search+bind authentication.</dd>

            
            
              <dt class="dt pt dlterm">ldapsearchattribute</dt>

              <dd class="dd pd">Attribute to match against the user name in the search when doing search+bind
                authentication.</dd>

            
          </dl>

        </div>

        <div class="p">Example:
          <pre class="pre codeblock"><code>ldapserver=ldap.greenplum.com prefix="cn=" suffix=", dc=greenplum, dc=com"</code></pre></div>

        <div class="p">Following are sample <code class="ph codeph">pg_hba.conf</code> file entries for LDAP authentication:
          <pre class="pre codeblock"><code>host all testuser 0.0.0.0/0 ldap ldap
ldapserver=ldapserver.greenplum.com ldapport=389 ldapprefix="cn=" ldapsuffix=",ou=people,dc=greenplum,dc=com"
hostssl   all   ldaprole   0.0.0.0/0   ldap
ldapserver=ldapserver.greenplum.com ldaptls=1 ldapprefix="cn=" ldapsuffix=",ou=people,dc=greenplum,dc=com"</code></pre></div>

      </div>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title5" id="topic_fzv_wb2_jr">
    <h2 class="title topictitle2" id="ariaid-title5">SSL Client Authentication</h2>

    <div class="body">
      <p class="p">SSL authentication compares the Common Name (cn) attribute of an SSL certificate provided
        by the connecting client during the SSL handshake to the requested database user name. The
        database user should exist in the database. A map file can be used for mapping between
        system and database user names. </p>

      <div class="section"><h3 class="title sectiontitle">SSL Authentication Parameters</h3>
        
        <div class="p">Authentication method:<ul class="ul" id="topic_fzv_wb2_jr__ul_fr4_fc2_jr">
            <li class="li">Cert<div class="p">Authentication options:<dl class="dl parml">
                  
                    <dt class="dt pt dlterm">Hostssl</dt>

                    <dd class="dd pd">Connection type must be hostssl.</dd>

                  
                  
                    <dt class="dt pt dlterm">map=<var class="keyword varname">mapping</var></dt>

                    <dd class="dd pd">mapping. </dd>

                    <dd class="dd pd ddexpand">This is specified in the <code class="ph codeph">pg_ident.conf</code>, or in the file
                      specified in the <code class="ph codeph">ident_file</code> server setting.</dd>

                  
                </dl>
</div>
<div class="p">Following are sample <code class="ph codeph">pg_hba.conf</code> entries for SSL
                client
                authentication:<pre class="pre codeblock"><code>Hostssl testdb certuser 192.168.0.0/16 cert
Hostssl testdb all 192.168.0.0/16 cert map=gpuser
</code></pre></div>
</li>

          </ul>
</div>

      </div>

      <div class="section" id="topic_fzv_wb2_jr__openssl_config"><h3 class="title sectiontitle">OpenSSL Configuration</h3>
        
        <p class="p">You can make changes to the OpenSSL configuration by updating the
            <code class="ph codeph">openssl.cnf</code> file under your OpenSSL installation directory, or the file
          referenced by <code class="ph codeph">$OPENSSL_CONF</code>, if present, and then restarting the
          Greenplum Database server.</p>

      </div>

      <div class="section" id="topic_fzv_wb2_jr__create_a_cert"><h3 class="title sectiontitle">Creating a Self-Signed Certificate</h3>
        
        <p class="p">A self-signed certificate can be used for testing, but a certificate signed by a
          certificate authority (CA) (either one of the global CAs or a local one) should be used in
          production so that clients can verify the server's identity. If all the clients are local
          to the organization, using a local CA is recommended. </p>

        <div class="p">To create a self-signed certificate for the server:<ol class="ol" id="topic_fzv_wb2_jr__ol_qpr_p4x_kr">
            <li class="li">Enter the following <code class="ph codeph">openssl</code>
              command:<pre class="pre codeblock"><code>openssl req -new -text -out server.req</code></pre></li>

            <li class="li">Enter the requested information at the prompts. <p class="p">Make sure you enter the local
                host name for the Common Name. The challenge password can be left blank. </p>
</li>

            <li class="li">The program generates a key that is passphrase-protected; it does not accept a
              passphrase that is less than four characters long. To remove the passphrase (and you
              must if you want automatic start-up of the server), run the following
              command:
              <pre class="pre codeblock"><code>openssl rsa -in privkey.pem -out server.key
rm privkey.pem</code></pre></li>

            <li class="li">Enter the old passphrase to unlock the existing key. Then run the following
                command:<pre class="pre codeblock"><code>openssl req -x509 -in server.req -text -key server.key -out server.crt</code></pre><p class="p">This
                turns the certificate into a self-signed certificate and copies the key and
                certificate to where the server will look for them. </p>
</li>

            <li class="li">Finally, run the following
              command:<pre class="pre codeblock"><code>chmod og-rwx server.key</code></pre></li>

          </ol>
</div>

        <p class="p">For more details on how to create your server private key and certificate, refer to the
          OpenSSL documentation. </p>

      </div>

      <div class="section" id="topic_fzv_wb2_jr__ssl_postgresql"><h3 class="title sectiontitle">Configuring postgresql.conf for SSL Authentication</h3>
        
        <div class="p">The following Server settings need to be specified in the
            <code class="ph codeph">postgresql.conf</code> configuration file: <ul class="ul" id="topic_fzv_wb2_jr__ul_bzs_b22_jr">
            <li class="li"><code class="ph codeph">ssl</code>
              <em class="ph i">boolean</em>. Enables SSL connections.</li>

            <li class="li"><code class="ph codeph">ssl_renegotiation_limit</code>
              <em class="ph i">integer</em>. Specifies the data limit before key renegotiation.</li>

            <li class="li"><code class="ph codeph">ssl_ciphers</code>
              <em class="ph i">string</em>. Configures the list SSL ciphers that are allowed.
                <code class="ph codeph">ssl_ciphers</code>
              <em class="ph i">overrides</em> any ciphers string specified in <code class="ph codeph">/etc/openssl.cnf</code>.
              The default value <code class="ph codeph">ALL:!ADH:!LOW:!EXP:!MD5:@STRENGTH</code> enables all
              ciphers except for ADH, LOW, EXP, and MD5 ciphers, and prioritizes ciphers by their
              strength.
              <div class="note"><span class="notetitle">Note:</span> With TLS 1.2 some ciphers in MEDIUM and HIGH strength still use NULL encryption
                (no encryption for transport), which the default <code class="ph codeph">ssl_ciphers</code> string
                allows. To bypass NULL ciphers with TLS 1.2 use a string such as
                  <code class="ph codeph">TLSv1.2:!eNULL:!aNULL</code>.<p class="p">It is possible to have authentication
                  without encryption overhead by using <code class="ph codeph">NULL-SHA</code> or
                    <code class="ph codeph">NULL-MD5</code> ciphers. However, a man-in-the-middle could read and
                  pass communications between client and server. Also, encryption overhead is
                  minimal compared to the overhead of authentication. For these reasons, NULL
                  ciphers should not be used.</p>
</div>
</li>

          </ul>
</div>

        <div class="p">The default location for the following SSL server files is the Greenplum Database master
          data directory (<code class="ph codeph">$MASTER_DATA_DIRECTORY</code>): <ul class="ul" id="topic_fzv_wb2_jr__ul_gzs_b22_jr">
            <li class="li"><code class="ph codeph">server.crt</code> - Server certificate.</li>

            <li class="li"><code class="ph codeph">server.key</code> - Server private key.</li>

            <li class="li"><code class="ph codeph">root.crt</code> - Trusted certificate authorities.</li>

            <li class="li"><code class="ph codeph">root.crl</code> - Certificates revoked by certificate authorities.</li>

          </ul>
</div>

        <p class="p">If Greenplum Database master mirroring is enabled with SSL client authentication, the SSL
          server files <em class="ph i">should not be placed</em> in the default directory
            <code class="ph codeph">$MASTER_DATA_DIRECTORY</code>. If a <code class="ph codeph">gpinitstandby</code> operation
          is performed, the contents of <code class="ph codeph">$MASTER_DATA_DIRECTORY</code> is copied from the
          master to the standby master and the incorrect SSL key, and cert files (the master files,
          and not the standby master files) will prevent standby master start up. </p>

        <p class="p">You can specify a different directory for the location of the SSL server files with the
            <code class="ph codeph">postgresql.conf</code> parameters <code class="ph codeph">sslcert</code>,
            <code class="ph codeph">sslkey</code>, <code class="ph codeph">sslrootcert</code>, and <code class="ph codeph">sslcrl</code>.</p>

      </div>

      <div class="section" id="topic_fzv_wb2_jr__config_ssl_client_conn"><h3 class="title sectiontitle">Configuring the SSL Client Connection</h3>
        
      </div>

      <div class="p">SSL options:<dl class="dl parml">
          
            <dt class="dt pt dlterm">sslmode</dt>

            <dd class="dd pd">Specifies the level of protection.<dl class="dl parml">
                
                  <dt class="dt pt dlterm">
                    <code class="ph codeph">require</code>
                  </dt>

                  <dd class="dd pd">Only use an SSL connection. If a root CA file is present, verify the
                    certificate in the same way as if <code class="ph codeph">verify-ca</code> was specified.</dd>

                
                
                  <dt class="dt pt dlterm">
                    <code class="ph codeph">verify-ca</code>
                  </dt>

                  <dd class="dd pd">Only use an SSL connection. Verify that the server certificate is issued by a
                    trusted CA.</dd>

                
                
                  <dt class="dt pt dlterm">
                    <code class="ph codeph">verify-full</code>
                  </dt>

                  <dd class="dd pd">Only use an SSL connection. Verify that the server certificate is issued by a
                    trusted CA and that the server host name matches that in the certificate.</dd>

                
              </dl>
</dd>

          
          
            <dt class="dt pt dlterm">sslcert</dt>

            <dd class="dd pd">The file name of the client SSL certificate. The default is
                <code class="ph codeph">$MASTER_DATA_DIRECTORY/postgresql.crt</code>. </dd>

          
          
            <dt class="dt pt dlterm">sslkey</dt>

            <dd class="dd pd">The secret key used for the client certificate. The default is
                <code class="ph codeph">$MASTER_DATA_DIRECTORY/postgresql.key</code>.</dd>

          
          
            <dt class="dt pt dlterm">sslrootcert</dt>

            <dd class="dd pd">The name of a file containing SSL Certificate Authority certificate(s). The default
              is <code class="ph codeph">$MASTER_DATA_DIRECTORY/root.crt</code>.</dd>

          
          
            <dt class="dt pt dlterm">sslcrl</dt>

            <dd class="dd pd">The name of the SSL certificate revocation list. The default is
                <code class="ph codeph">$MASTER_DATA_DIRECTORY/root.crl</code>.</dd>

          
        </dl>
</div>

      <div class="p">The client connection parameters can be set using the following environment variables:<ul class="ul" id="topic_fzv_wb2_jr__ul_yph_5g2_jr">
          <li class="li"><code class="ph codeph">sslmode</code> – <code class="ph codeph">PGSSLMODE</code></li>

          <li class="li"><code class="ph codeph">sslcert</code> – <code class="ph codeph">PGSSLCERT</code></li>

          <li class="li"><code class="ph codeph">sslkey</code> – <code class="ph codeph">PGSSLKEY</code></li>

          <li class="li"><code class="ph codeph">sslrootcert</code> – <code class="ph codeph">PGSSLROOTCERT</code></li>

          <li class="li"><code class="ph codeph">sslcrl</code> – <code class="ph codeph">PGSSLCRL</code> </li>

        </ul>
</div>

      <div class="p">For example, run the following command to connect to the <code class="ph codeph">postgres</code> database
        from <code class="ph codeph">localhost</code> and verify the certificate present in the default location
        under <code class="ph codeph">$MASTER_DATA_DIRECTORY</code>:
        <pre class="pre codeblock"><code>psql "sslmode=verify-ca host=localhost dbname=postgres"</code></pre></div>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title6" id="topic_yxp_5h2_jr">
    <h2 class="title topictitle2" id="ariaid-title6">PAM-Based Authentication</h2>

    <div class="body">
      <p class="p">The "PAM" (Pluggable Authentication Modules) authentication method validates
        username/password pairs, similar to basic authentication. To use PAM
        authentication, the user must already exist as a Greenplum Database role name.</p>

      <p class="p">Greenplum uses the <code class="ph codeph">pamservice</code> authentication parameter
        to identify the service from which to obtain the PAM configuration.</p>

      <div class="note"><span class="notetitle">Note:</span> If PAM is set up to read <code class="ph codeph">/etc/shadow</code>, authentication will
        fail because the PostgreSQL server is started by a non-root user. This is not
        an issue when PAM is configured to use LDAP or another authentication method.</div>

      <p class="p">Greenplum Database does not install a PAM configuration file. If you choose
        to use PAM authentication with Greenplum, you must identify the PAM service
        name for Greenplum and create the associated PAM service configuration file
        and configure Greenplum Database to use PAM authentication as described below:</p>

      <ol class="ol">
        <li class="li">Log in to the Greenplum Database master host and set up your environment.
          For example:<pre class="pre codeblock"><code>$ ssh gpadmin@&lt;gpmaster&gt;
gpadmin@gpmaster$ . /usr/local/greenplum-db/greenplum_path.sh</code></pre></li>

        <li class="li">Identify the <code class="ph codeph">pamservice</code> name for Greenplum Database. In
          this procedure, we choose the name <code class="ph codeph">greenplum</code>.</li>

        <li class="li">Create the PAM service configuration file, <code class="ph codeph">/etc/pam.d/greenplum</code>,
          and add the text below. You must have operating system superuser
          privileges to create the <code class="ph codeph">/etc/pam.d</code> directory (if
          necessary) and the <code class="ph codeph">greenplum</code> PAM configuration file.
<pre class="pre codeblock"><code>#%PAM-1.0
auth		include		password-auth
account		include		password-auth
</code></pre>
          <p class="p">This configuration instructs PAM to authenticate the local operating
            system user.</p>
</li>

        <li class="li">Ensure that the <code class="ph codeph">/etc/pam.d/greenplum</code> file is readable
          by all users: <pre class="pre codeblock"><code>sudo chmod 644 /etc/pam.d/greenplum</code></pre></li>

        <li class="li">Add one or more entries to the <code class="ph codeph">pg_hba.conf</code> configuration
          file to enable PAM authentication in Greenplum Database. These entries must
          specify the <code class="ph codeph">pam</code> <em class="ph i">auth-method</em>. You must also specify
          the <code class="ph codeph">pamservice=greenplum</code> <em class="ph i">auth-option</em>. For example:
<pre class="pre codeblock"><code>
host     &lt;user-name&gt;     &lt;db-name&gt;     &lt;address&gt;     pam     pamservice=greenplum
</code></pre></li>

        <li class="li">Reload the Greenplum Database configuration:
          <pre class="pre codeblock"><code>$ gpstop -u</code></pre></li>

      </ol>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title7" id="topic_ed4_d32_jr">
    <h2 class="title topictitle2" id="ariaid-title7">Radius Authentication</h2>

    <div class="body">
      <p class="p">RADIUS (Remote Authentication Dial In User Service) authentication works by sending an
        Access Request message of type 'Authenticate Only' to a configured RADIUS server. It
        includes parameters for user name, password (encrypted), and the Network Access Server (NAS)
        Identifier. The request is encrypted using the shared secret specified in the
          <code class="ph codeph">radiussecret</code> option. The RADIUS server responds with either
          <code class="ph codeph">Access Accept</code> or <code class="ph codeph">Access Reject</code>. </p>

      <div class="note"><span class="notetitle">Note:</span> RADIUS accounting is not supported.</div>

      <p class="p"> RADIUS authentication only works if the users already exist in the database.</p>

      <p class="p">The RADIUS encryption vector requires SSL to be enabled in order to be cryptographically
        strong.</p>

      <div class="section"><h3 class="title sectiontitle">RADIUS Authentication Options</h3>
        
        <dl class="dl parml">
          
            <dt class="dt pt dlterm">radiusserver</dt>

            <dd class="dd pd">The name of the RADIUS server.</dd>

          
          
            <dt class="dt pt dlterm">radiussecret</dt>

            <dd class="dd pd">The RADIUS shared secret.</dd>

          
          
            <dt class="dt pt dlterm">radiusport</dt>

            <dd class="dd pd">The port to connect to on the RADIUS server.</dd>

          
          
            <dt class="dt pt dlterm">radiusidentifier</dt>

            <dd class="dd pd">NAS identifier in RADIUS requests.</dd>

          
        </dl>

      </div>

      <div class="p">Following are sample <code class="ph codeph">pg_hba.conf</code> entries for RADIUS client
        authentication:<pre class="pre codeblock"><code>hostssl  all all 0.0.0.0/0 radius radiusserver=servername radiussecret=<var class="keyword varname">sharedsecret</var></code></pre></div>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title8" id="topic_hwn_bk2_jr">
    <h2 class="title topictitle2" id="ariaid-title8">Limiting Concurrent Connections</h2>

    <div class="body">
      <p class="p">To limit the number of active concurrent sessions to your Greenplum Database system, you
        can configure the <code class="ph codeph">max_connections</code> server configuration parameter. This is a
        local parameter, meaning that you must set it in the <code class="ph codeph">postgresql.conf</code> file
        of the master, the standby master, and each segment instance (primary and mirror). The value
        of <code class="ph codeph">max_connections</code> on segments must be 5-10 times the value on the master. </p>

      <p class="p">When you set <code class="ph codeph">max_connections</code>, you must also set the dependent parameter
          <code class="ph codeph">max_prepared_transactions</code>. This value must be at least as large as the
        value of <code class="ph codeph">max_connections</code> on the master, and segment instances should be set
        to the same value as the master. </p>

      <div class="p">In <code class="ph codeph">$MASTER_DATA_DIRECTORY/postgresql.conf</code> (including standby
        master):<pre class="pre codeblock"><code>max_connections=100
max_prepared_transactions=100</code></pre></div>

      <div class="p">In <code class="ph codeph">SEGMENT_DATA_DIRECTORY/postgresql.conf</code> for all segment
        instances:<pre class="pre codeblock"><code>max_connections=500
max_prepared_transactions=100</code></pre></div>

      <div class="note"><span class="notetitle">Note:</span> Note: Raising the values of these parameters may cause Greenplum Database to request
        more shared memory. To mitigate this effect, consider decreasing other memory-related
        parameters such as <code class="ph codeph">gp_cached_segworkers_threshold</code>.</div>

      <div class="p">To change the number of allowed connections:<ol class="ol" id="topic_hwn_bk2_jr__ol_etb_rk2_jr">
          <li class="li">Stop your Greenplum Database system:<pre class="pre codeblock"><code>$ gpstop</code></pre></li>

          <li class="li">On the master host, edit <code class="ph codeph">$MASTER_DATA_DIRECTORY/postgresql.conf</code> and
            change the following two parameters:<ul class="ul" id="topic_hwn_bk2_jr__ul_e5k_vk2_jr">
              <li class="li"><code class="ph codeph">max_connections</code> – the number of active user sessions you want to
                allow plus the number of <code class="ph codeph">superuser_reserved_connections</code>.</li>

              <li class="li"><code class="ph codeph">max_prepared_transactions</code> – must be greater than or equal to
                  <code class="ph codeph">max_connections</code>.</li>

            </ul>
</li>

          <li class="li">On each segment instance, edit <code class="ph codeph">SEGMENT_DATA_DIRECTORY/postgresql.conf</code>
            and change the following two parameters:<ul class="ul" id="topic_hwn_bk2_jr__ul_iwf_1l2_jr">
              <li class="li"><code class="ph codeph">max_connections</code> – must be 5-10 times the value on the
                master.</li>

              <li class="li"><code class="ph codeph">max_prepared_transactions</code> – must be equal to the value on the
                master.</li>

            </ul>
</li>

          <li class="li">Restart your Greenplum Database system:<pre class="pre codeblock"><code>$ gpstart</code></pre></li>

        </ol>
</div>

    </div>

  </div>

  <div class="topic nested1" aria-labelledby="ariaid-title9" id="topic_ibc_nl2_jr">
    <h2 class="title topictitle2" id="ariaid-title9">Encrypting Client/Server Connections</h2>

    <div class="body">
      <p class="p">Greenplum Database has native support for SSL connections between the client and the master
        server. SSL connections prevent third parties from snooping on the packets, and also prevent
        man-in-the-middle attacks. SSL should be used whenever the client connection goes through an
        insecure link, and must be used whenever client certificate authentication is used. </p>

      <div class="note"><span class="notetitle">Note:</span> For information about encrypting data between the <code class="ph codeph">gpfdist</code> server and
        Greenplum Database segment hosts, see <a class="xref" href="Encryption.html#gpfdist_connections">Encrypting gpfdist Connections</a>. </div>

      <p class="p">To enable SSL requires that OpenSSL be installed on both the client and the master server
        systems. Greenplum can be started with SSL enabled by setting the server configuration
        parameter <code class="ph codeph">ssl=on</code> in the master <code class="ph codeph">postgresql.conf</code>. When
        starting in SSL mode, the server will look for the files <code class="ph codeph">server.key</code> (server
        private key) and <code class="ph codeph">server.crt</code> (server certificate) in the master data
        directory. These files must be set up correctly before an SSL-enabled Greenplum system can
        start.</p>

      <div class="note important"><span class="importanttitle">Important:</span> Do not protect the private key with a passphrase. The server does not
        prompt for a passphrase for the private key, and the database startup fails with an error if
        one is required.</div>

      <p class="p">A self-signed certificate can be used for testing, but a certificate signed by a
        certificate authority (CA) should be used in production, so the client can verify the
        identity of the server. Either a global or local CA can be used. If all the clients are
        local to the organization, a local CA is recommended. See <a class="xref" href="#topic_fzv_wb2_jr__create_a_cert">Creating a Self-Signed Certificate</a> for steps to create a self-signed
        certificate.</p>

    </div>

  </div>

</body>
</html>