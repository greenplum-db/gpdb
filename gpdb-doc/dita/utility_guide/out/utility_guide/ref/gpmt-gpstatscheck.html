<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="gpmt gpstatscheck" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>gpmt gpstatscheck</title>
</head>
<body id="topic1">
<h1 class="title topictitle1" id="topic1__oz137116">gpmt gpstatscheck</h1>
<div class="body">
    <p class="p">This tool can be used to verify if all tables involved in a query have optimal statistics.
      When a query is running slower than expected, it is possible that outdated or invalid
      statistics on the tables involved in the query are causing the slowness. This can happen if
      new data has been loaded into the table but <code class="ph codeph">analyze</code> was never run, so
      the database is using wrong statistics when generating the query plan.</p>

    <div class="section"><h2 class="title sectiontitle">Usage</h2>
      
      <pre class="pre codeblock"><code><strong class="ph b">gpmt</strong> <strong class="ph b">gpstatscheck</strong> -f QUERYFILE
[<var class="keyword varname">-p PORT</var>] [<var class="keyword varname">-d DATABASE]</var> </code></pre>
    </div>

    <div class="section"><h2 class="title sectiontitle">Options</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm"><var class="keyword varname">-f </var></dt>

          <dd class="dd pd">File containing the query to analyze.</dd>

        
        
          <dt class="dt pt dlterm"><var class="keyword varname">-p </var></dt>

          <dd class="dd pd">Database port.</dd>

        
        
          <dt class="dt pt dlterm"><var class="keyword varname">-d</var></dt>

          <dd class="dd pd">Database where the query is being run.</dd>

        
      </dl>

    </div>

    <div class="section"><h2 class="title sectiontitle">Examples</h2>
      
      <p class="p">Run the query in <code class="ph codeph">query1.sql</code> in database <code class="ph codeph">Postgres</code> and
        check for missing stats. </p>

      <pre class="pre codeblock"><code>gpmt gpstatscheck -f query1.sql -d postgres</code></pre>
      <p class="p">If invalid statistics are detected the tool will generate a script listing the suggested
        commands to run. For example:</p>

      <pre class="pre codeblock"><code>$ cat gpstatscheck_20160926_134946.sql
ANALYZE public.nums;</code></pre>
      <p class="p">You can then run the provided script against the affected database:</p>

      <pre class="pre codeblock"><code>$ psql -p 5432 -d postgres -f gpstatscheck_20160926_134946.sql</code></pre>
    </div>

  </div>
</body>
</html>