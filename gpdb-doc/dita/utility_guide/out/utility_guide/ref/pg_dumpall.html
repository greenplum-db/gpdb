<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="pg_dumpall" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="topic1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>pg_dumpall</title>
</head>
<body id="topic1">

    <h1 class="title topictitle1" id="topic1__or137116">pg_dumpall</h1>

    <div class="body">
        <p class="p" id="topic1__client_util_desc">Extracts all databases in a Greenplum Database system
            to a single script file or other archive file.</p>

        <div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2>
            
            <pre class="pre codeblock" id="topic1__client_util_synopsis"><code>pg_dumpall [&lt;connection-option&gt; ...] [&lt;dump_option&gt; ...]

pg_dumpall -? | --help

pg_dumpall -V | --version</code></pre>
        </div>

        <div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2>
            
            <p class="p"><code class="ph codeph">pg_dumpall</code> is a standard PostgreSQL utility for backing up all
                databases in a Greenplum Database (or PostgreSQL) instance, and is also supported in
                Greenplum Database. It creates a single (non-parallel) dump file. <span class="ph">For routine
                    backups of Greenplum Database it is better to use the Greenplum Database backup
                    utility, <a class="xref" href="gpbackup.html#topic1">gpbackup</a>, for the best performance.</span></p>

            <p class="p"><code class="ph codeph">pg_dumpall</code> creates a single script file that contains SQL commands
                that can be used as input to <a class="xref" href="psql.html#topic1">psql</a> to restore the databases. It does this by calling <a class="xref" href="pg_dump.html#topic1">pg_dump</a> for each database. <code class="ph codeph">pg_dumpall</code> also
                dumps global objects that are common to all databases. (<code class="ph codeph">pg_dump</code>
                does not save these objects.) This currently includes information about database
                users and groups, and access permissions that apply to databases as a whole.</p>

            <p class="p">Since <code class="ph codeph">pg_dumpall</code> reads tables from all databases you will most
                likely have to connect as a database superuser in order to produce a complete dump.
                Also you will need superuser privileges to run the saved script in order to be
                allowed to add users and groups, and to create databases.</p>

            <p class="p">The SQL script will be written to the standard output. Use the
              <code class="ph codeph">[-f | --file]</code> option or shell operators
                to redirect it into a file.</p>

            <p class="p"><code class="ph codeph">pg_dumpall</code> needs to connect several times to the Greenplum Database coordinator server (once per database). If you use password
                authentication it is likely to ask for a password each time. It is convenient to
                have a <code class="ph codeph">~/.pgpass</code> file in such cases.</p>

        </div>

        <div class="section" id="topic1__section4"><h2 class="title sectiontitle">Options</h2>
            
            <div class="sectiondiv" id="topic1__section5">
                <strong class="ph b">Dump Options</strong>
                <dl class="dl parml">
                    
                        <dt class="dt pt dlterm">-a | --data-only</dt>

                        <dd class="dd pd">Dump only the data, not the schema (data definitions). This option is
                            only meaningful for the plain-text format. For the archive formats, you
                            may specify the option when you call <a class="xref" href="pg_restore.html#topic1">pg_restore</a>. </dd>

                    
                    
                        <dt class="dt pt dlterm">-c | --clean</dt>

                        <dd class="dd pd">Output commands to clean (drop) database objects prior to (the commands
                            for) creating them. This option is only meaningful for the plain-text
                            format. For the archive formats, you may specify the option when you
                            call <a class="xref" href="pg_restore.html#topic1">pg_restore</a>. </dd>

                    
                    
                        <dt class="dt pt dlterm">-f <var class="keyword varname">filename</var> | --file=<var class="keyword varname">filename</var></dt>

                        <dd class="dd pd">Send output to the specified file. </dd>

                    
                    
                        <dt class="dt pt dlterm">-g | --globals-only</dt>

                        <dd class="dd pd">Dump only global objects (roles and tablespaces), no databases.</dd>

                    
                    
                        <dt class="dt pt dlterm">-o | --oids</dt>

                        <dd class="dd pd">Dump object identifiers (OIDs) as part of the data for every table. Use
                            of this option is not recommended for files that are intended to be
                            restored into Greenplum Database.</dd>

                    
                    
                        <dt class="dt pt dlterm">-O | --no-owner</dt>

                        <dd class="dd pd">Do not output commands to set ownership of objects to match the original
                            database. By default, <a class="xref" href="pg_dump.html#topic1">pg_dump</a> issues <code class="ph codeph">ALTER OWNER</code> or <code class="ph codeph">SET
                                SESSION AUTHORIZATION</code> statements to set ownership of
                            created database objects. These statements will fail when the script is
                            run unless it is started by a superuser (or the same user that owns all
                            of the objects in the script). To make a script that can be restored by
                            any user, but will give that user ownership of all the objects, specify
                                <code class="ph codeph">-O</code>. This option is only meaningful for the
                            plain-text format. For the archive formats, you may specify the option
                            when you call <a class="xref" href="pg_restore.html#topic1">pg_restore</a>.</dd>

                    
                    
                        <dt class="dt pt dlterm">-r | --roles-only</dt>

                        <dd class="dd pd">Dump only roles, not databases or tablespaces.</dd>

                    
                    
                        <dt class="dt pt dlterm">-s | --schema-only</dt>

                        <dd class="dd pd">Dump only the object definitions (schema), not data.</dd>

                    
                    
                        <dt class="dt pt dlterm">-S <var class="keyword varname">username</var> |
                            --superuser=<var class="keyword varname">username</var></dt>

                        <dd class="dd pd">Specify the superuser user name to use when disabling triggers. This is
                            relevant only if <code class="ph codeph">--disable-triggers</code> is used. It is
                            better to leave this out, and instead start the resulting script as a
                                superuser.<div class="note"><span class="notetitle">Note:</span> Greenplum Database does not support user-defined
                                triggers.</div>
</dd>

                    
                    
                        <dt class="dt pt dlterm">-t | --tablespaces-only</dt>

                        <dd class="dd pd">Dump only tablespaces, not databases or roles.</dd>

                    
                    
                        <dt class="dt pt dlterm">-v | --verbose</dt>

                        <dd class="dd pd">Specifies verbose mode. This will cause <code class="ph codeph"><a class="xref" href="pg_dump.html#topic1">pg_dump</a></code>
                            to output detailed object comments and start/stop times to the dump
                            file, and progress messages to standard error.</dd>

                    
                    
                      <dt class="dt pt dlterm">-V | --version</dt>

                      <dd class="dd pd">Print the <code class="ph codeph">pg_dumpall</code> version and exit.</dd>

                    
                    
                        <dt class="dt pt dlterm">-x | --no-privileges | --no-acl</dt>

                        <dd class="dd pd">Prevent dumping of access privileges (<code class="ph codeph">GRANT/REVOKE</code>
                            commands).</dd>

                    
                    
                        <dt class="dt pt dlterm">--binary-upgrade</dt>

                        <dd class="dd pd">This option is for use by in-place upgrade utilities. Its use for other
                            purposes is not recommended or supported. The behavior of the option may
                            change in future releases without notice.</dd>

                    
                    
                        <dt class="dt pt dlterm">--column-inserts | --attribute-inserts</dt>

                        <dd class="dd pd">Dump data as <code class="ph codeph">INSERT</code> commands with explicit column names
                                (<code class="ph codeph">INSERT INTO &lt;table&gt; (&lt;column&gt;, ...) VALUES
                                ...</code>). This will make restoration very slow; it is mainly
                            useful for making dumps that can be loaded into non-PostgreSQL-based
                            databases. Also, since this option generates a separate command for each
                            row, an error in reloading a row causes only that row to be lost rather
                            than the entire table contents.</dd>

                    
                    
                        <dt class="dt pt dlterm">--disable-dollar-quoting</dt>

                        <dd class="dd pd">This option disables the use of dollar quoting for function bodies, and
                            forces them to be quoted using SQL standard string syntax.</dd>

                    
                    
                        <dt class="dt pt dlterm">--disable-triggers</dt>

                        <dd class="dd pd">This option is relevant only when creating a data-only dump. It
                            instructs <code class="ph codeph">pg_dumpall</code> to include commands to temporarily
                            disable triggers on the target tables while the data is reloaded. Use
                            this if you have triggers on the tables that you do not want to invoke
                            during data reload. The commands emitted for
                                <code class="ph codeph">--disable-triggers</code> must be done as superuser. So,
                            you should also specify a superuser name with <code class="ph codeph">-S</code>, or
                            preferably be careful to start the resulting script as a
                                superuser.<div class="note"><span class="notetitle">Note:</span> Greenplum Database does not support user-defined
                                triggers.</div>
</dd>

                    
                    
                        <dt class="dt pt dlterm">--inserts</dt>

                        <dd class="dd pd">Dump data as <code class="ph codeph">INSERT</code> commands (rather than
                                <code class="ph codeph">COPY</code>). This will make restoration very slow; it is
                            mainly useful for making dumps that can be loaded into
                            non-PostgreSQL-based databases. Also, since this option generates a
                            separate command for each row, an error in reloading a row causes only
                            that row to be lost rather than the entire table contents. Note that the
                            restore may fail altogether if you have rearranged column order. The
                                <code class="ph codeph">--column-inserts</code> option is safe against column
                            order changes, though even slower. </dd>

                    
                    
                        <dt class="dt pt dlterm">--lock-wait-timeout=<var class="keyword varname">timeout</var></dt>

                        <dd class="dd pd">Do not wait forever to acquire shared table locks at the beginning of
                            the dump. Instead, fail if unable to lock a table within the specified
                                <var class="keyword varname">timeout</var>. The timeout may be specified in any of
                            the formats accepted by <code class="ph codeph">SET statement_timeout</code>. Allowed
                            values vary depending on the server version you are dumping from, but an
                            integer number of milliseconds is accepted by all Greenplum Database
                            versions.</dd>

                    
                    
                        <dt class="dt pt dlterm">--no-security-labels</dt>

                        <dd class="dd pd">Do not dump security labels.</dd>

                    
                    
                        <dt class="dt pt dlterm">--no-tablespaces</dt>

                        <dd class="dd pd">Do not output commands to select tablespaces. With this option, all
                            objects will be created in whichever tablespace is the default during
                            restore.</dd>

                    
                    
                        <dt class="dt pt dlterm">--no-unlogged-table-data</dt>

                        <dd class="dd pd">Do not dump the contents of unlogged tables. This option has no
                          effect on whether or not the table definitions (schema) are dumped;
                           it only suppresses dumping the table data.</dd>

                    
                    
                        <dt class="dt pt dlterm">--quote-all-identifiers</dt>

                        <dd class="dd pd">Force quoting of all identifiers. This option is recommended when
                          dumping a database from a server whose Greenplum Database major
                          version is different from <code class="ph codeph">pg_dumpall</code>'s, or when
                          the output is intended to be loaded into a server of a different
                           major version. By default, <code class="ph codeph">pg_dumpall</code> quotes only
                           identifiers that are reserved words in its own major version. This
                           sometimes results in compatibility issues when dealing with servers
                           of other versions that may have slightly different sets of reserved
                           words. Using <code class="ph codeph">--quote-all-identifiers</code> prevents such
                           issues, at the price of a harder-to-read dump script.</dd>

                    
                    
                        <dt class="dt pt dlterm">--resource-queues</dt>

                        <dd class="dd pd">Dump resource queue definitions.</dd>

                    
                    
                        <dt class="dt pt dlterm">--resource-groups</dt>

                        <dd class="dd pd">Dump resource group definitions.</dd>

                    
                    
                        <dt class="dt pt dlterm">--use-set-session-authorization</dt>

                        <dd class="dd pd">Output SQL-standard <code class="ph codeph">SET SESSION AUTHORIZATION</code> commands
                            instead of <code class="ph codeph">ALTER OWNER</code> commands to determine object
                            ownership. This makes the dump more standards compatible, but depending
                            on the history of the objects in the dump, may not restore properly. A
                            dump using <code class="ph codeph">SET SESSION AUTHORIZATION</code> will require
                            superuser privileges to restore correctly, whereas <code class="ph codeph">ALTER
                                OWNER</code> requires lesser privileges.</dd>

                    
                    
                        <dt class="dt pt dlterm">--gp-syntax</dt>

                        <dd class="dd pd">Output Greenplum Database syntax in the <code class="ph codeph">CREATE
                                TABLE</code> statements. This allows the distribution policy
                                (<code class="ph codeph">DISTRIBUTED BY</code> or <code class="ph codeph">DISTRIBUTED
                                RANDOMLY</code> clauses) of a Greenplum Database
                            table to be dumped, which is useful for restoring into other Greenplum Database systems.</dd>

                    
                    
                        <dt class="dt pt dlterm">--no-gp-syntax</dt>

                        <dd class="dd pd">Do not output the table distribution clauses in the <code class="ph codeph">CREATE
                                TABLE</code> statements. </dd>

                    
                    
                      <dt class="dt pt dlterm">-? | --help</dt>

                      <dd class="dd pd">Show help about <code class="ph codeph">pg_dumpall</code> command line arguments, and exit.</dd>

                    
                </dl>

            </div>
            <div class="sectiondiv" id="topic1__section6">
                <strong class="ph b">Connection Options</strong>
                <dl class="dl parml">
                    
                        <dt class="dt pt dlterm">-d <var class="keyword varname">connstr</var> | --dbname=<var class="keyword varname">connstr</var></dt>

                        <dd class="dd pd">Specifies parameters used to connect to the server, as a connection
                            string. See <a class="xref" href="https://www.postgresql.org/docs/9.4/libpq-connect.html#LIBPQ-CONNSTRING" target="_blank">Connection Strings</a> in the
                            PostgreSQL documentation for more information.</dd>

                        <dd class="dd pd ddexpand">The option is called <code class="ph codeph">--dbname</code> for consistency with
                            other client applications, but because <code class="ph codeph">pg_dumpall</code> needs
                            to connect to many databases, the database name in the connection string
                            will be ignored. Use the <code class="ph codeph">-l</code> option to specify the name
                            of the database used to dump global objects and to discover what other
                            databases should be dumped.</dd>

                    
                    
                        <dt class="dt pt dlterm">-h <var class="keyword varname">host</var> | --host=<var class="keyword varname">host</var></dt>

                        <dd class="dd pd">The host name of the machine on which the Greenplum coordinator database server is running. If
                            not specified, reads from the environment variable
                                <code class="ph codeph">PGHOST</code> or defaults to
                            <code class="ph codeph">localhost</code>.</dd>

                    
                    
                        <dt class="dt pt dlterm">-l <var class="keyword varname">dbname</var> | --database=<var class="keyword varname">dbname</var></dt>

                        <dd class="dd pd">Specifies the name of the database in which to connect to dump global objects. If not specified, the <code class="ph codeph">postgres</code> database is used. If the <code class="ph codeph">postgres</code> database does not exist, the <code class="ph codeph">template1</code> database is used.</dd>

                    
                    
                        <dt class="dt pt dlterm">-p <var class="keyword varname">port</var> | --port=<var class="keyword varname">port</var></dt>

                        <dd class="dd pd">The TCP port on which the Greenplum coordinator
                            database server is listening for connections. If not specified, reads
                            from the environment variable <code class="ph codeph">PGPORT</code> or defaults to
                            5432.</dd>

                    
                    
                        <dt class="dt pt dlterm">-U <var class="keyword varname">username</var> | --username=
                            <var class="keyword varname">username</var></dt>

                        <dd class="dd pd">The database role name to connect as. If not specified, reads from the
                            environment variable <code class="ph codeph">PGUSER</code> or defaults to the current
                            system role name.</dd>

                    
                    
                        <dt class="dt pt dlterm">-w | --no-password</dt>

                        <dd class="dd pd">Never issue a password prompt. If the server requires password
                            authentication and a password is not available by other means such as a
                                <code class="ph codeph">.pgpass</code> file the connection attempt will fail. This
                            option can be useful in batch jobs and scripts where no user is present
                            to enter a password.</dd>

                    
                    
                        <dt class="dt pt dlterm">-W | --password</dt>

                        <dd class="dd pd">Force a password prompt.</dd>

                    
                    
                        <dt class="dt pt dlterm">--role=<var class="keyword varname">rolename</var></dt>

                        <dd class="dd pd">Specifies a role name to be used to create the dump. This option causes
                                <code class="ph codeph">pg_dumpall</code> to issue a <code class="ph codeph">SET ROLE
                                &lt;rolename&gt;</code> command after connecting to the database. It
                            is useful when the authenticated user (specified by <code class="ph codeph">-U</code>)
                            lacks privileges needed by <code class="ph codeph">pg_dumpall</code>, but can switch
                            to a role with the required rights. Some installations have a policy
                            against logging in directly as a superuser, and use of this option
                            allows dumps to be made without violating the policy.</dd>

                    
                </dl>

            </div>
        </div>

        <div class="section" id="topic1__section7"><h2 class="title sectiontitle">Notes</h2>
            
            <p class="p">Since <code class="ph codeph">pg_dumpall</code> calls <a class="xref" href="pg_dump.html#topic1">pg_dump</a> internally, some diagnostic messages will refer to
                    <code class="ph codeph">pg_dump</code>. </p>

            <p class="p">Once restored, it is wise to run <code class="ph codeph">ANALYZE</code> on each database so the
                query planner has useful statistics. You can also run <code class="ph codeph">vacuumdb -a
                    -z</code> to vacuum and analyze all databases. </p>

            <p class="p"><code class="ph codeph">pg_dumpall</code> requires all needed tablespace directories to
                exist before the restore; otherwise, database creation will fail for
                databases in non-default locations.</p>

        </div>

        <div class="section" id="topic1__section8"><h2 class="title sectiontitle">Examples</h2>
            
            <p class="p">To dump all databases: </p>

            <pre class="pre codeblock"><code>pg_dumpall &gt; db.out</code></pre>
            <p class="p">To reload database(s) from this file, you can use:</p>

            <pre class="pre codeblock"><code>psql template1 -f db.out</code></pre>
            <p class="p">To dump only global objects (including resource queues):</p>

            <pre class="pre codeblock"><code>pg_dumpall -g --resource-queues</code></pre>
        </div>

        <div class="section" id="topic1__section9"><h2 class="title sectiontitle">See Also</h2>
            
            <p class="p">
                <a class="xref" href="pg_dump.html#topic1">pg_dump</a>
            </p>

        </div>

    </div>

</body>
</html>